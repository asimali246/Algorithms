<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0070)http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" type="text/css" href="./Manacher_Algorithm_files/fY7BDgIhDER_aBE9-EEFKpAssGm7Ufx6uyzxpodmmubNdK6Wpa-43C2EkqtxQBfV5WbdHkLfCJmt24xvhNbr_sUU8TtLK_mNwRB6rKJYKao80DP5eZir6NXGYFiADIHkGgdzrkcWQW_VcK8CL5NyTKuOIA1Mf05itvuNS8KCbGOWtLspfw2PNgq3ym0F_gA.css" media="all"><link rel="stylesheet" type="text/css" href="./Manacher_Algorithm_files/M9Qvzy9KKShKLS7WLcgvKM1JLALSxSXF-sUllTmp-uUFBQA.css" media="all"><script type="text/javascript" async="" src="./Manacher_Algorithm_files/ga.js"></script><script type="text/javascript" src="./Manacher_Algorithm_files/LYtrDsMgDIMvRBZN632m8BBQQeiSVBu3H532w3LsfH7g_jqTTHfHHEGNBISscsZdV6OyHkFoDgadbPSBUnNpS5bkYnrlP3Bbp3sfEAZbYkMrqSdFf8Y4_VDFZ-WAuQ1PzW0YRu8LA0lHm7_thhSXgye58hc.js"></script><style type="text/css"></style><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Longest Palindromic Substring Part II | LeetCode</title><link rel="pingback" href="http://leetcode.com/xmlrpc.php"><link rel="shortcut icon" href="http://leetcode.com/wp-content/themes/buddyboss-child/_inc/images/favicon.ico" type="image/x-icon"><link rel="alternate" type="application/rss+xml" title="LeetCode » Feed" href="http://leetcode.com/feed"><link rel="alternate" type="application/rss+xml" title="LeetCode » Comments Feed" href="http://leetcode.com/comments/feed"><link rel="alternate" type="application/rss+xml" title="LeetCode » Longest Palindromic Substring Part II Comments Feed" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html/feed"><link rel="stylesheet" id="gdsr_style_main-css" href="./Manacher_Algorithm_files/gdsr.css.php" type="text/css" media="all"><script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.2.0","is_admin":"0","ajaxurl":"http:\/\/leetcode.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script><script type="text/javascript">
/* <![CDATA[ */
var BP_DTheme = {"my_favs":"My Likes","accepted":"Accepted","rejected":"Rejected","show_all_comments":"Show all comments for this thread","show_all":"Show all","comments":"comments","close":"Close","view":"View","mark_as_fav":"Like","remove_fav":"Unlike","add_photo":"Add Photo","cancel":"Cancel","failed":"Failed","person":"person","people":"people","like":"like","likes":"likes","this_1":"this"};
/* ]]> */
</script><link rel="prev" title="Longest Palindromic Substring Part I" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-i.html"><link rel="next" title="Palindrome Number" href="http://leetcode.com/2012/01/palindrome-number.html"><link rel="canonical" href="./Manacher_Algorithm_files/Manacher_Algorithm.html"><link rel="shortlink" href="http://leetcode.com/?p=993"><script type="text/javascript">var ajaxurl = 'http://leetcode.com/wp-admin/admin-ajax.php';</script><style type="text/css">#sidebar span.collapsing.archives {
        border:0;
        padding:0; 
        margin:0; 
        cursor:pointer;
} 

#sidebar span.monthCount, span.yearCount {text-decoration:none; color:#333}
#sidebar li.collapsing.archives a.self {font-weight:bold}
#sidebar ul.collapsing.archives.list ul.collapsing.archives.list:before {content:\'\';} 
#sidebar ul.collapsing.archives.list li.collapsing.archives:before {content:\'\';} 
#sidebar ul.collapsing.archives.list li.collapsing.archives {list-style-type:none}
#sidebar ul.collapsing.archives.list li {
       margin:0 0 0 .8em;
       text-indent:-1em}
#sidebar ul.collapsing.archives.list li.collapsing.archives.item:before {content: \'\\00BB \\00A0\' !important;} 
#sidebar ul.collapsing.archives.list li.collapsing.archives .sym {
   font-size:1.2em;
   font-family:Monaco, \'Andale Mono\', \'FreeMono\', \'Courier new\', \'Courier\', monospace;
   cursor:pointer;
    padding-right:15px;}
#sidebar ul.collapsing.archives.list span.collapsing.archives.collapse .sym {
    background-image: url(/wp-content/plugins/collapsing-archives/img/list-collapse.gif);
}
#sidebar ul.collapsing.archives.list span.collapsing.archives.expand .sym {
    background-image: url(/wp-content/plugins/collapsing-archives/img/list-expand.gif);
}</style><script type="text/javascript">
//<![CDATA[
var gdsr_cnst_nonce = "ab8b9e53e6";
var gdsr_cnst_ajax = "http://leetcode.com/wp-content/plugins/gd-star-rating/ajax.php";
var gdsr_cnst_button = 1;
var gdsr_cnst_cache = 0;
// ]]>
</script><!--[if IE]><style type="text/css">.ratemulti .starsbar .gdcurrent { -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=70)"; filter: alpha(opacity=70); }</style><![endif]--> <script type="text/javascript">
    /* <![CDATA[ */				
	jQuery.post('http://leetcode.com/wp-admin/admin-ajax.php', {action: 'wpp_update', token: 'a46bf87c40', id: 993}, function(data){/*alert(data);*/});
    /* ]]> */
</script><style type="text/css" media="print">#wpadminbar { display:none; }</style><style type="text/css" media="screen">
	html { margin-top: 28px !important; }
	* html body { margin-top: 28px !important; }
</style><script type="text/javascript"> jQuery(document).ready( function() { jQuery("a.confirm").click( function() { if ( confirm( 'Are you sure?' ) ) return true; else return false; }); });</script><style>[touch-action="none"]{ -ms-touch-action: none; touch-action: none; }[touch-action="pan-x"]{ -ms-touch-action: pan-x; touch-action: pan-x; }[touch-action="pan-y"]{ -ms-touch-action: pan-y; touch-action: pan-y; }[touch-action="scroll"],[touch-action="pan-x pan-y"],[touch-action="pan-y pan-x"]{ -ms-touch-action: pan-x pan-y; touch-action: pan-x pan-y; }</style><style id="clearly_highlighting_css" type="text/css">/* selection */ html.clearly_highlighting_enabled ::-moz-selection { background: rgba(246, 238, 150, 0.99); } html.clearly_highlighting_enabled ::selection { background: rgba(246, 238, 150, 0.99); } /* cursor */ html.clearly_highlighting_enabled {    /* cursor and hot-spot position -- requires a default cursor, after the URL one */    cursor: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--cursor.png") 14 16, text; } /* highlight tag */ em.clearly_highlight_element {    font-style: inherit !important; font-weight: inherit !important;    background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--yellow.png");    background-repeat: repeat-x; background-position: top left; background-size: 100% 100%; } /* the delete-buttons are positioned relative to this */ em.clearly_highlight_element.clearly_highlight_first { position: relative; } /* delete buttons */ em.clearly_highlight_element a.clearly_highlight_delete_element {    display: none; cursor: pointer;    padding: 0; margin: 0; line-height: 0;    position: absolute; width: 34px; height: 34px; left: -17px; top: -17px;    background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--delete-sprite.png"); background-repeat: no-repeat; background-position: 0px 0px; } em.clearly_highlight_element a.clearly_highlight_delete_element:hover { background-position: -34px 0px; } /* retina */ @media (min--moz-device-pixel-ratio: 2), (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {    em.clearly_highlight_element { background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--yellow@2x.png"); }    em.clearly_highlight_element a.clearly_highlight_delete_element { background-image: url("chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/images/highlight--delete-sprite@2x.png"); background-size: 68px 34px; } } </style></head><body class="single single-post postid-993 single-format-standard admin-bar no-customize-support js buddyboss-active-pics buddyboss-active-wall admin-bar" id="bp-default"> <!--[if lte IE 6]><script src="http://leetcode.com/wp-content/themes/buddyboss/_inc/js/ie6/warning.js"></script><script>window.onload=function(){e("http://leetcode.com/wp-content/themes/buddyboss-child/_inc/js/ie6/")}</script><![endif]--><script type="text/javascript">//<![CDATA[
(function(){var c=document.body.className;c=c.replace(/no-js/,'js');document.body.className=c;})();
//]]></script><div id="top-hdr-bg"></div><div class="menu-bg"></div><div id="wrapper"><div id="header"><div class="padder"><div id="logo"> <a href="http://leetcode.com/" title="Home"><img src="./Manacher_Algorithm_files/leetcodelogo.png"></a></div><div class="menu-bg"></div><ul class="sf-menu sf-js-enabled sf-shadow"><li class="page_item page-item-2"><a href="http://leetcode.com/about">About</a></li><li class="page_item page-item-908"><a href="http://leetcode.com/activity">Activity</a></li><li class="page_item page-item-1466"><a href="http://leetcode.com/discuss">Discuss</a></li><li class="page_item page-item-1658"><a href="http://leetcode.com/donate">Donate</a></li><li class="page_item page-item-907"><a href="http://leetcode.com/members">Members</a></li><li class="page_item page-item-370"><a href="http://leetcode.com/onlinejudge">Online Judge</a></li></ul></div></div><div id="container"><div id="content" class="two_column"><div class="padder"><div class="page" id="blog-single" role="main"><div id="post-993" class="post-993 post type-post status-publish format-standard hentry category-string"><div class="author-box"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar of 1337c0d3r" class="avatar user-8268-avatar" width="50" height="50"><p>by <a rel="author" href="http://leetcode.com/members/admin/" title="1337c0d3r">1337c0d3r</a></p></div><div class="post-content"><h2 class="posttitle">Longest Palindromic Substring Part II</h2><p class="date"> November 20, 2011 <span>in <a href="http://leetcode.com/category/string" title="View all posts in string" rel="category tag">string</a></span> <span class="post-utility alignright"></span></p><div class="entry"><blockquote><p>Given a string S, find the longest palindromic substring in S.</p></blockquote><p><strong><span style="color: red;">Note:</span></strong><br> This is Part II of the article: <a href="http://www.leetcode.com/2011/11/longest-palindromic-substring-part-i.html">Longest Palindromic Substring</a>. Here, we describe an algorithm (Manacher’s algorithm) which finds the longest palindromic substring in linear time. Please read <a href="http://www.leetcode.com/2011/11/longest-palindromic-substring-part-i.html">Part I</a> for more background information.<br> <span id="more-993"></span><br> In my <a href="http://www.leetcode.com/2011/11/longest-palindromic-substring-part-i.html">previous post</a> we discussed a total of four different methods, among them there’s a pretty simple algorithm with O(N<sup>2</sup>) run time and constant space complexity. Here, we discuss an algorithm that runs in O(N) time and O(N) space, also known as Manacher’s algorithm.</p><p><strong>Hint:</strong><br> Think how you would improve over the simpler O(N<sup>2</sup>) approach. Consider the worst case scenarios. The worst case scenarios are the inputs with multiple palindromes overlapping each other. For example, the inputs: “aaaaaaaaa” and “cabcbabcbabcba”. In fact, we could take advantage of the palindrome’s symmetric property and avoid some of the unnecessary computations.</p><p><strong>An O(N) Solution (Manacher’s Algorithm):</strong><br> First, we transform the input string, S, to another string T by inserting a special character ‘#’ in between letters. The reason for doing so will be immediately clear to you soon.</p><p>For example: S = “abaaba”, T = “#a#b#a#a#b#a#”.</p><p>To find the longest palindromic substring, we need to expand around each T<sub>i</sub> such that T<sub>i-d</sub> … T<sub>i+d</sub> forms a palindrome. You should immediately see that <em>d</em> is the length of the palindrome itself centered at T<sub>i</sub>.</p><p>We store intermediate result in an array P, where P[ i ] equals to the length of the palindrome centers at T<sub>i</sub>. The longest palindromic substring would then be the maximum element in P.</p><p>Using the above example, we populate P as below (from left to right):</p><pre class="hiblock">T = # a # b # a # a # b # a #
P = 0 1 0 3 0 1 6 1 0 3 0 1 0</pre><p>Looking at P, we immediately see that the longest palindrome is “abaaba”, as indicated by P<sub>6</sub> = 6.</p><p>Did you notice by inserting special characters (#) in between letters, both palindromes of odd and even lengths are handled graciously? (Please note: This is to demonstrate the idea more easily and is not necessarily needed to code the algorithm.)</p><p>Now, imagine that you draw an imaginary vertical line at the center of the palindrome “abaaba”. Did you notice the numbers in P are symmetric around this center? That’s not only it, try another palindrome “aba”, the numbers also reflect similar symmetric property. Is this a coincidence? The answer is yes and no. This is only true subjected to a condition, but anyway, we have great progress, since we can eliminate recomputing part of P[ i ]‘s.</p><p>Let us move on to a slightly more sophisticated example with more some overlapping palindromes, where S = “babcbabcbaccba”.</p><div style="text-align: center; margin-bottom: 30px;"><a href="./Manacher_Algorithm_files/palindrome_table10.png"><img class="size-full wp-image-1014" title="palindrome_table10" src="./Manacher_Algorithm_files/palindrome_table10.png" alt="" width="640" height="99"></a><br> <span style="font-size: x-small;">Above image shows T transformed from S = “babcbabcbaccba”. Assumed that you reached a state where table P is partially completed. The solid vertical line indicates the center (C) of the palindrome “abcbabcba”. The two dotted vertical line indicate its left (L) and right (R) edges respectively. You are at index i and its mirrored index around C is i’. How would you calculate P[ i ] efficiently? </span></div><p>Assume that we have arrived at index i = 13, and we need to calculate P[ 13 ] (indicated by the question mark ?). We first look at its mirrored index i’ around the palindrome’s center C, which is index i’ = 9.</p><div style="text-align: center; margin-bottom: 30px;"><a href="./Manacher_Algorithm_files/palindrome_table11.png"><img class="size-full wp-image-1015" title="palindrome_table11" src="./Manacher_Algorithm_files/palindrome_table11.png" alt="" width="640" height="99"></a><br> <span style="font-size: x-small;">The two green solid lines above indicate the covered region by the two palindromes centered at i and i’. We look at the mirrored index of i around C, which is index i’. P[ i' ] = P[ 9 ] = 1. It is clear that P[ i ] must also be 1, due to the symmetric property of a palindrome around its center. </span></div><p>As you can see above, it is very obvious that P[ i ] = P[ i' ] = 1, which must be true due to the symmetric property around a palindrome’s center. In fact, all three elements after C follow the symmetric property (that is, P[ 12 ] = P[ 10 ] = 0, P[ 13 ] = P[ 9 ] = 1, P[ 14 ] = P[ 8 ] = 0).</p><div style="text-align: center; margin-bottom: 30px;"><a href="./Manacher_Algorithm_files/palindrome_table4.png"><img class="size-full wp-image-1004" title="palindrome_table4" src="./Manacher_Algorithm_files/palindrome_table4.png" alt="" width="640" height="99"></a><br> <span style="font-size: x-small;">Now we are at index i = 15, and its mirrored index around C is i’ = 7. Is P[ 15 ] = P[ 7 ] = 7? </span></div><p>Now we are at index i = 15. What’s the value of <nobr>P[ i ]</nobr>? If we follow the symmetric property, the value of <nobr>P[ i ]</nobr> should be the same as P[ i' ] = 7. But this is wrong. If we expand around the center at T<sub>15</sub>, it forms the palindrome “a#b#c#b#a”, which is actually shorter than what is indicated by its symmetric counterpart. Why?</p><div style="text-align: center; margin-bottom: 30px;"><a href="./Manacher_Algorithm_files/palindrome_table5.png"><img class="size-full wp-image-1006" title="palindrome_table5" src="./Manacher_Algorithm_files/palindrome_table5.png" alt="" width="640" height="99"></a><br> <span style="font-size: x-small;">Colored lines are overlaid around the center at index i and i’. Solid green lines show the region that must match for both sides due to symmetric property around C. Solid red lines show the region that might not match for both sides. Dotted green lines show the region that crosses over the center. </span></div><p>It is clear that the two substrings in the region indicated by the two solid green lines must match exactly. Areas across the center (indicated by dotted green lines) must also be symmetric. Notice carefully that P[ i ' ] is 7 and it expands all the way across the left edge (L) of the palindrome (indicated by the solid red lines), which does not fall under the symmetric property of the palindrome anymore. All we know is <nobr>P[ i ]</nobr> ≥ 5, and to find the real value of P[ i ] we have to do character matching by expanding past the right edge (R). In this case, since P[ 21 ] ≠ P[ 1 ], we conclude that P[ i ] = 5.</p><p>Let’s summarize the key part of this algorithm as below:</p><div class="hiblock"><strong>if</strong> P[ i' ] ≤ R – i,<br> <strong>then </strong>P[ i ] ← P[ i' ]<br> <strong>else </strong>P[ i ] ≥ P[ i' ]. (Which we have to expand past the right edge (R) to find P[ i ].</div><p>See how elegant it is? If you are able to grasp the above summary fully, you already obtained the essence of this algorithm, which is also the hardest part.</p><p>The final part is to determine when should we move the position of C together with R to the right, which is easy:</p><div class="hiblock"> If the palindrome centered at i does expand past R, we update C to i, (the center of this new palindrome), and extend R to the new palindrome’s right edge.</div><p>In each step, there are two possibilities. If P[ i ] ≤ R – i, we set P[ i ] to P[ i' ] which takes exactly one step. Otherwise we attempt to change the palindrome’s center to i by expanding it starting at the right edge, R. Extending R (the inner while loop) takes at most a total of N steps, and positioning and testing each centers take a total of N steps too. Therefore, this algorithm guarantees to finish in at most 2*N steps, giving a linear time solution.</p><p></p><div id="crayon-53a66820568f0" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 13px !important; line-height: 16px !important; height: auto;"><div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 16px !important; z-index: 0; opacity: 0; overflow: hidden;">// Transform S into T.
// For example, S = "abba", T = "^#a#b#b#a#$".
// ^ and $ signs are sentinels appended to each end to avoid bounds checking
string preProcess(string s) {
  int n = s.length();
  if (n == 0) return "^$";
  string ret = "^";
  for (int i = 0; i &lt; n; i++)
    ret += "#" + s.substr(i, 1);

  ret += "#$";
  return ret;
}

string longestPalindrome(string s) {
  string T = preProcess(s);
  int n = T.length();
  int *P = new int[n];
  int C = 0, R = 0;
  for (int i = 1; i &lt; n-1; i++) {
    int i_mirror = 2*C-i; // equals to i' = C - (i-C)
    
    P[i] = (R &gt; i) ? min(R-i, P[i_mirror]) : 0;
    
    // Attempt to expand palindrome centered at i
    while (T[i + 1 + P[i]] == T[i - 1 - P[i]])
      P[i]++;

    // If palindrome centered at i expand past R,
    // adjust center based on expanded palindrome.
    if (i + P[i] &gt; R) {
      C = i;
      R = i + P[i];
    }
  }

  // Find the maximum element in P.
  int maxLen = 0;
  int centerIndex = 0;
  for (int i = 1; i &lt; n-1; i++) {
    if (P[i] &gt; maxLen) {
      maxLen = P[i];
      centerIndex = i;
    }
  }
  delete[] P;
  
  return s.substr((centerIndex - 1 - maxLen)/2, maxLen);
}</textarea></div><div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><table class="crayon-table" style="margin-left: -28px;"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-num" data-line="crayon-53a66820568f0-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-2">2</div><div class="crayon-num" data-line="crayon-53a66820568f0-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-4">4</div><div class="crayon-num" data-line="crayon-53a66820568f0-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-6">6</div><div class="crayon-num" data-line="crayon-53a66820568f0-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-8">8</div><div class="crayon-num" data-line="crayon-53a66820568f0-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-10">10</div><div class="crayon-num" data-line="crayon-53a66820568f0-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-12">12</div><div class="crayon-num" data-line="crayon-53a66820568f0-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-14">14</div><div class="crayon-num" data-line="crayon-53a66820568f0-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-16">16</div><div class="crayon-num" data-line="crayon-53a66820568f0-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-18">18</div><div class="crayon-num" data-line="crayon-53a66820568f0-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-20">20</div><div class="crayon-num" data-line="crayon-53a66820568f0-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-22">22</div><div class="crayon-num" data-line="crayon-53a66820568f0-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-24">24</div><div class="crayon-num" data-line="crayon-53a66820568f0-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-26">26</div><div class="crayon-num" data-line="crayon-53a66820568f0-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-28">28</div><div class="crayon-num" data-line="crayon-53a66820568f0-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-30">30</div><div class="crayon-num" data-line="crayon-53a66820568f0-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-32">32</div><div class="crayon-num" data-line="crayon-53a66820568f0-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-34">34</div><div class="crayon-num" data-line="crayon-53a66820568f0-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-36">36</div><div class="crayon-num" data-line="crayon-53a66820568f0-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-38">38</div><div class="crayon-num" data-line="crayon-53a66820568f0-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-40">40</div><div class="crayon-num" data-line="crayon-53a66820568f0-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-42">42</div><div class="crayon-num" data-line="crayon-53a66820568f0-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-44">44</div><div class="crayon-num" data-line="crayon-53a66820568f0-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-46">46</div><div class="crayon-num" data-line="crayon-53a66820568f0-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a66820568f0-48">48</div><div class="crayon-num" data-line="crayon-53a66820568f0-49">49</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-line" id="crayon-53a66820568f0-1"><span class="c">// Transform S into T.</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-2"><span class="c">// For example, S = "abba", T = "^#a#b#b#a#$".</span></div><div class="crayon-line" id="crayon-53a66820568f0-3"><span class="c">// ^ and $ signs are sentinels appended to each end to avoid bounds checking</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-4"><span class="t">string</span><span class="h"> </span><span class="e">preProcess</span><span class="sy">(</span><span class="t">string</span><span class="h"> </span><span class="i">s</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53a66820568f0-5"><span class="h">&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">n</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">s</span><span class="sy">.</span><span class="e">length</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-6"><span class="h">&nbsp;&nbsp;</span><span class="st">if</span><span class="h"> </span><span class="sy">(</span><span class="v">n</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="st">return</span><span class="h"> </span><span class="s">"^$"</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-7"><span class="h">&nbsp;&nbsp;</span><span class="t">string</span><span class="h"> </span><span class="v">ret</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="s">"^"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-8"><span class="h">&nbsp;&nbsp;</span><span class="st">for</span><span class="h"> </span><span class="sy">(</span><span class="t">int</span><span class="h"> </span><span class="v">i</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="i">n</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="o">++</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53a66820568f0-9"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="i">ret</span><span class="h"> </span><span class="o">+</span><span class="o">=</span><span class="h"> </span><span class="s">"#"</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">s</span><span class="sy">.</span><span class="e">substr</span><span class="sy">(</span><span class="i">i</span><span class="sy">,</span><span class="h"> </span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-10">&nbsp;</div><div class="crayon-line" id="crayon-53a66820568f0-11"><span class="h">&nbsp;&nbsp;</span><span class="i">ret</span><span class="h"> </span><span class="o">+</span><span class="o">=</span><span class="h"> </span><span class="s">"#$"</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-12"><span class="h">&nbsp;&nbsp;</span><span class="st">return</span><span class="h"> </span><span class="i">ret</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-13"><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-14">&nbsp;</div><div class="crayon-line" id="crayon-53a66820568f0-15"><span class="t">string</span><span class="h"> </span><span class="e">longestPalindrome</span><span class="sy">(</span><span class="t">string</span><span class="h"> </span><span class="i">s</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-16"><span class="h">&nbsp;&nbsp;</span><span class="t">string</span><span class="h"> </span><span class="v">T</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="e">preProcess</span><span class="sy">(</span><span class="i">s</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-17"><span class="h">&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">n</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">T</span><span class="sy">.</span><span class="e">length</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-18"><span class="h">&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="o">*</span><span class="v">P</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="r">new</span><span class="h"> </span><span class="t">int</span><span class="sy">[</span><span class="i">n</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-19"><span class="h">&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">C</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">,</span><span class="h"> </span><span class="v">R</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-20"><span class="h">&nbsp;&nbsp;</span><span class="st">for</span><span class="h"> </span><span class="sy">(</span><span class="t">int</span><span class="h"> </span><span class="v">i</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">1</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="i">n</span><span class="o">-</span><span class="cn">1</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="o">++</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53a66820568f0-21"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">i_mirror</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">2</span><span class="o">*</span><span class="i">C</span><span class="o">-</span><span class="i">i</span><span class="sy">;</span><span class="h"> </span><span class="c">// equals to i' = C - (i-C)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-22"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a66820568f0-23"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="sy">(</span><span class="i">R</span><span class="h"> </span><span class="o">&gt;</span><span class="h"> </span><span class="i">i</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="e">min</span><span class="sy">(</span><span class="i">R</span><span class="o">-</span><span class="i">i</span><span class="sy">,</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i_mirror</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-24"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a66820568f0-25"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c">// Attempt to expand palindrome centered at i</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-26"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">while</span><span class="h"> </span><span class="sy">(</span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53a66820568f0-27"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">++</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-28">&nbsp;</div><div class="crayon-line" id="crayon-53a66820568f0-29"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c">// If palindrome centered at i expand past R,</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-30"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c">// adjust center based on expanded palindrome.</span></div><div class="crayon-line" id="crayon-53a66820568f0-31"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">if</span><span class="h"> </span><span class="sy">(</span><span class="i">i</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="h"> </span><span class="o">&gt;</span><span class="h"> </span><span class="i">R</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-32"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">C</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="i">i</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-33"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">R</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="i">i</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-34"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53a66820568f0-35"><span class="h">&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-36">&nbsp;</div><div class="crayon-line" id="crayon-53a66820568f0-37"><span class="h">&nbsp;&nbsp;</span><span class="c">// Find the maximum element in P.</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-38"><span class="h">&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">maxLen</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-39"><span class="h">&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">centerIndex</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-40"><span class="h">&nbsp;&nbsp;</span><span class="st">for</span><span class="h"> </span><span class="sy">(</span><span class="t">int</span><span class="h"> </span><span class="v">i</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">1</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="i">n</span><span class="o">-</span><span class="cn">1</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="o">++</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53a66820568f0-41"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">if</span><span class="h"> </span><span class="sy">(</span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="h"> </span><span class="o">&gt;</span><span class="h"> </span><span class="i">maxLen</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-42"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">maxLen</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-43"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">centerIndex</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="i">i</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-44"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53a66820568f0-45"><span class="h">&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-46"><span class="h">&nbsp;&nbsp;</span><span class="v">delete</span><span class="sy">[</span><span class="sy">]</span><span class="h"> </span><span class="i">P</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-47"><span class="h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a66820568f0-48"><span class="h">&nbsp;&nbsp;</span><span class="st">return</span><span class="h"> </span><span class="v">s</span><span class="sy">.</span><span class="e">substr</span><span class="sy">(</span><span class="sy">(</span><span class="i">centerIndex</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="i">maxLen</span><span class="sy">)</span><span class="o">/</span><span class="cn">2</span><span class="sy">,</span><span class="h"> </span><span class="i">maxLen</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a66820568f0-49"><span class="sy">}</span></div></div></td></tr></tbody></table></div></div><p></p><p><strong><span style="color: red">Note:</span></strong><br> This algorithm is definitely non-trivial and you won’t be expected to come up with such algorithm during an interview setting. However, I do hope that you enjoy reading this article and hopefully it helps you in understanding this interesting algorithm. You deserve a pat if you have gone this far! <img src="./Manacher_Algorithm_files/icon_smile.gif" alt=":)" class="wp-smiley"></p><p><strong><span style="color: red">Further Thoughts:</span></strong></p><ul><li>In fact, there exists a sixth solution to this problem — Using suffix trees. However, it is not as efficient as this one (run time O(N log N) and more overhead for building suffix trees) and is more complicated to implement. If you are interested, read Wikipedia’s article about <a href="http://en.wikipedia.org/wiki/Longest_palindromic_substring">Longest Palindromic Substring</a>.</li><li>What if you are required to find the longest palindromic subsequence? (Do you know the difference between substring and subsequence?)</li></ul><p><strong><span style="color: red">Useful Links:</span></strong><br> » <a href="http://www.felix021.com/blog/read.php?2040">Manacher’s Algorithm O(N) 时间求字符串的最长回文子串</a> (Best explanation if you can read Chinese)<br> » <a href="http://zhuhongcheng.wordpress.com/2009/08/02/a-simple-linear-time-algorithm-for-finding-longest-palindrome-sub-string/">A simple linear time algorithm for finding longest palindrome sub-string</a><br> » <a href="http://johanjeuring.blogspot.com/2007/08/finding-palindromes.html">Finding Palindromes</a><br> » <a href="http://www.akalin.cx/longest-palindrome-linear-time">Finding the Longest Palindromic Substring in Linear Time</a><br> » <a href="http://en.wikipedia.org/wiki/Longest_palindromic_substring">Wikipedia: Longest Palindromic Substring</a></p><div style="display: none">VN:F [1.9.22_1171]</div><div class="ratingblock "><div class="ratingheader "></div><div class="ratingstars "><div id="article_rater_993" class="ratepost gdsr-oxygen_gif gdsr-size-24"><div class="starsbar gdsr-size-24"><div class="gdouter gdheight"><div id="gdr_vote_a993" style="width: 113.72307692308px;" class="gdinner gdheight"></div><div id="gdr_stars_a993" class="gdsr_rating_as"><a id="gdsrX993X5X0XaXarticle_rater_993Xarticle_loader_993X10X24" title="5 / 5" class="s5" rel="nofollow"></a><a id="gdsrX993X4X0XaXarticle_rater_993Xarticle_loader_993X10X24" title="4 / 5" class="s4" rel="nofollow"></a><a id="gdsrX993X3X0XaXarticle_rater_993Xarticle_loader_993X10X24" title="3 / 5" class="s3" rel="nofollow"></a><a id="gdsrX993X2X0XaXarticle_rater_993Xarticle_loader_993X10X24" title="2 / 5" class="s2" rel="nofollow"></a><a id="gdsrX993X1X0XaXarticle_rater_993Xarticle_loader_993X10X24" title="1 / 5" class="s1" rel="nofollow"></a></div></div></div></div><div id="article_loader_993" style="display: none; width: 120px " class="ratingloaderarticle"><div class="loader radar " style="height: 24px"><div class="loaderinner" style="padding-top: 2px">please wait...</div></div></div></div><div class="ratingtext "><div id="gdr_text_a993">Rating: 4.7/<strong>5</strong> (65 votes cast)</div></div></div><span class="hreview-aggregate"><span class="item"><span class="fn">Longest Palindromic Substring Part II</span></span>, <span class="rating"><span class="average">4.7</span> out of <span class="best">5</span> based on <span class="votes">65</span> ratings <span class="summary"></span></span></span></div><p class="postmetadata">&nbsp;</p><div class="alignleft"><a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-i.html" rel="prev"><span class="meta-nav">←</span> Longest Palindromic Substring Part I</a></div><div class="alignright"><a href="http://leetcode.com/2012/01/palindrome-number.html" rel="next">Palindrome Number <span class="meta-nav">→</span></a></div></div></div><div id="comments"><h3> 85 responses to <em>Longest Palindromic Substring Part II</em></h3><ol class="commentlist"><li class="comment even thread-even depth-1" id="comment-6938"><div class="comment-avatar-box"><div class="avb"> <a href="http://www.acoolme.com/" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/03838041b00348a2f45ee5575ea2198f" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://www.acoolme.com/" rel="nofollow">wayne</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-6938"><span class="time-since">November 21, 2011</span></a></p></div><div class="comment-entry"><p>i think my solution is simpler than this one, the key point of my solution is:<br> The center point of palindromic substring is always follow this pattern, either is “…..XyX…..” or “….XX….”.</p><p>so you can scan once and then find those center point of palindromic substring and then  expand it on each center points to find the one with maxium length.</p><p>i ve already posted my java solution in the comments of  Longest Palindromic Substring Part I</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_6938_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 10 down">-9</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_6938_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX6938XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6938_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_6938_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX6938XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6938_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=6938#respond" onclick="return addComment.moveForm(&quot;comment-6938&quot;, &quot;6938&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="comment-6980"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-6980"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>Yes your solution is simpler but runs in O(N^2) worst case. It is already discussed in my previous post.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_6980_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 1 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_6980_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX6980XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6980_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_6980_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX6980XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6980_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=6980#respond" onclick="return addComment.moveForm(&quot;comment-6980&quot;, &quot;6980&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment even depth-3" id="comment-6996"><div class="comment-avatar-box"><div class="avb"> <a href="http://www.acoolme.com/" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/03838041b00348a2f45ee5575ea2198f(1)" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://www.acoolme.com/" rel="nofollow">wayne</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-6996"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>i agreed, it is O(N^2) worst case, thanks.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_6996_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 3 down">-3</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_6996_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX6996XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6996_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_6996_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX6996XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6996_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=6996#respond" onclick="return addComment.moveForm(&quot;comment-6996&quot;, &quot;6996&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor odd alt depth-4" id="comment-7020"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7020"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>No problem.<br> Basically this algorithm is an improvement over your method. It is using the symmetric property of a palindrome to eliminate some of the recomputations of palindrome’s length, and amazingly improve it to a linear time solution.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7020_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 1 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7020_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7020XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7020_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7020_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7020XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7020_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7020#respond" onclick="return addComment.moveForm(&quot;comment-7020&quot;, &quot;7020&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li></ul></li><li class="comment even depth-2" id="comment-25922"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/a8577b18950c9efc1e7f010cc95136b3" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Andres</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-25922"><span class="time-since">September 24, 2012</span></a></p></div><div class="comment-entry"><p>Excellent post, I learnt a lot</p><p>Thanks!</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_25922_c" class="gdt-size-20 gdthumbtext"> <strong title="2 up, 4 down">-2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_25922_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX25922XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_25922_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_25922_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX25922XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_25922_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=25922#respond" onclick="return addComment.moveForm(&quot;comment-25922&quot;, &quot;25922&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-guojiaagain odd alt depth-2" id="comment-115733"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/guojiaagain/" rel="nofollow"> <img src="./Manacher_Algorithm_files/4f0b2fc79224a90133ef91d137e8bf96" alt="Avatar Image" class="avatar user-28495-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/guojiaagain/" rel="nofollow">GuojiaAgain</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-115733"><span class="time-since">January 20, 2014</span></a></p></div><div class="comment-entry"><p>Your implementation is simpler but cost more time.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_115733_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 1 down">-1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_115733_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX115733XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_115733_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_115733_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX115733XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_115733_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=115733#respond" onclick="return addComment.moveForm(&quot;comment-115733&quot;, &quot;115733&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-6974"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/c6c667b43de09e03b48fb8f23e041907" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Sreekar</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-6974"><span class="time-since">November 21, 2011</span></a></p></div><div class="comment-entry"><p>Looks like this is O(N^2) algorithm as there is a while loop in for loop. Could you please clarify?</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_6974_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 5 down">-4</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_6974_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX6974XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6974_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_6974_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX6974XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6974_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=6974#respond" onclick="return addComment.moveForm(&quot;comment-6974&quot;, &quot;6974&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="comment-6979"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-6979"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>Even with the extra while loop inside, it is guaranteed in the worst case the algorithm completes in 2*n steps.</p><p>Think of how the i and right edge (R) relates. In the loop each time, you look if this index is a candidate to re-position the palindrome’s center. If it is, you increment the existing R one at a time. See? R could only be incremented at most N steps. Once you incremented a total of N steps, it couldn’t be incremented any more. It’s not like you will increment R all the time in the while loop. This is called amortized O(1).</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_6979_c" class="gdt-size-20 gdthumbtext"> <strong title="3 up, 1 down">+2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_6979_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX6979XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6979_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_6979_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX6979XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6979_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=6979#respond" onclick="return addComment.moveForm(&quot;comment-6979&quot;, &quot;6979&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment even depth-3" id="comment-34709"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/4373a964d92d6256e0883cad882b1dcb" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Vikas</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-34709"><span class="time-since">January 5, 2013</span></a></p></div><div class="comment-entry"><p>How is it amortised O(1) ? I am confused from the definition from amortise.</p><p>Amortised to me means , for a worst case of runs of some operations its amortised cost over all of them</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_34709_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 2 down">-2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_34709_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX34709XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_34709_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_34709_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX34709XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_34709_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=34709#respond" onclick="return addComment.moveForm(&quot;comment-34709&quot;, &quot;34709&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt depth-3" id="comment-147794"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/b308260a3bb2cbd93769ddcd9fd78565" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">yy</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-147794"><span class="time-since">March 20, 2014</span></a></p></div><div class="comment-entry"><p>Great, I see why it’s amortized O(1) now. Thanks!</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_147794_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 2 down">-2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_147794_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX147794XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_147794_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_147794_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX147794XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_147794_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=147794#respond" onclick="return addComment.moveForm(&quot;comment-147794&quot;, &quot;147794&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li></ul></li><li class="comment even thread-even depth-1" id="comment-6981"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/c6c667b43de09e03b48fb8f23e041907" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Sreekar</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-6981"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>Got it. Thanks for the clarification. Great solution</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_6981_c" class="gdt-size-20 gdthumbtext"> <strong title="2 up, 2 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_6981_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX6981XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6981_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_6981_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX6981XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6981_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=6981#respond" onclick="return addComment.moveForm(&quot;comment-6981&quot;, &quot;6981&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="comment-7019"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7019"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>Thanks! Hope you understands it. Let me know if you have any more questions!</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7019_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 2 down">-2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7019_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7019XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7019_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7019_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7019XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7019_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7019#respond" onclick="return addComment.moveForm(&quot;comment-7019&quot;, &quot;7019&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment even depth-3" id="comment-15664"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/5fccee4b36c71b8ae593324fbb7a69f9" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">coderrush</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-15664"><span class="time-since">February 29, 2012</span></a></p></div><div class="comment-entry"><p>I am wondering if the algorithm is O(NlgN) or O(N)?</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_15664_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 1 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_15664_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX15664XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_15664_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_15664_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX15664XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_15664_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=15664#respond" onclick="return addComment.moveForm(&quot;comment-15664&quot;, &quot;15664&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li></ul></li><li class="comment byuser comment-author-florinbunau odd alt thread-odd thread-alt depth-1" id="comment-6990"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/florinbunau/" rel="nofollow"> <img src="./Manacher_Algorithm_files/f24e483300649b747015c908f21de04f-bpthumb.jpg" alt="Avatar Image" class="avatar user-260-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/florinbunau/" rel="nofollow">flo</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-6990"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>Great write-up. Thanks for the article</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_6990_c" class="gdt-size-20 gdthumbtext"> <strong title="2 up, 1 down">+1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_6990_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX6990XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6990_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_6990_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX6990XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_6990_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=6990#respond" onclick="return addComment.moveForm(&quot;comment-6990&quot;, &quot;6990&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor even depth-2" id="comment-7018"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7018"><span class="time-since">November 22, 2011</span></a></p></div><div class="comment-entry"><p>Thanks!<br> My goal of writing this article is to provide an intuitive way to understand the algorithm. I hope you really appreciate the beauty of this algorithm.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7018_c" class="gdt-size-20 gdthumbtext"> <strong title="2 up, 0 down">+2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7018_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7018XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7018_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7018_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7018XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7018_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7018#respond" onclick="return addComment.moveForm(&quot;comment-7018&quot;, &quot;7018&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-3" id="comment-19269"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/5bfa47f01c70feab4b88bc90183777af" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">J</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-19269"><span class="time-since">May 5, 2012</span></a></p></div><div class="comment-entry"><p>I would if I could understand it.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_19269_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 1 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_19269_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX19269XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19269_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_19269_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX19269XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19269_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=19269#respond" onclick="return addComment.moveForm(&quot;comment-19269&quot;, &quot;19269&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li></ul></li><li class="comment even thread-even depth-1" id="comment-7099"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/9e5251756acc8f49d0bd5c12600fe158" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">vaibhav</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7099"><span class="time-since">November 24, 2011</span></a></p></div><div class="comment-entry"><p>while explaining how to fill P[i] you mentioned<br> ”<br> if P[ i' ] ≤ R – i,<br> then P[ i ] ← P[ i' ]<br> else P[ i ] ≥ P[ i' ]. (Which we have to expand past the right edge (R) to find P[ i ].<br> ”<br> is the else statement right?? shouldnt be “else P[ i' ] ≥ P[ i ]“</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7099_c" class="gdt-size-20 gdthumbtext"> <strong title="5 up, 0 down">+5</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7099_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7099XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7099_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7099_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7099XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7099_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7099#respond" onclick="return addComment.moveForm(&quot;comment-7099&quot;, &quot;7099&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-ironmanz odd alt depth-2" id="comment-60097"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/ironmanz/" rel="nofollow"> <img src="./Manacher_Algorithm_files/07e76ba22845b4f14e7d42444acdd360-bpthumb.jpg" alt="Avatar Image" class="avatar user-6214-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/ironmanz/" rel="nofollow">ironmanz</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-60097"><span class="time-since">May 17, 2013</span></a></p></div><div class="comment-entry"><p>I agree with you.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_60097_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_60097_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX60097XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_60097_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_60097_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX60097XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_60097_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=60097#respond" onclick="return addComment.moveForm(&quot;comment-60097&quot;, &quot;60097&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-7109"><div class="comment-avatar-box"><div class="avb"> <a href="http://web.iiit.ac.in/~kumarsrijan" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/543d57365f4d5c0f37d7c599d1c3bf09" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://web.iiit.ac.in/~kumarsrijan" rel="nofollow">bleu</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7109"><span class="time-since">November 24, 2011</span></a></p></div><div class="comment-entry"><p>It should rather be:<br> else P[ i ] ≥ (R-i) (Which we have to expand past the right edge (R) to find P[ i ])<br> .. Also note how coherent the reasoning in the bracket sounds now.</p><p>Explanation :<br> When P[i'] &gt; R-i then all we know, by symmetry about C, is :<br> P[i'] &gt; R-i .. by obviousness<br> and<br> P[i] ≥ R-i .. by the meaning of R<br> From this we clearly cannot conclude upon  max(P[i'], P[i])</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7109_c" class="gdt-size-20 gdthumbtext"> <strong title="4 up, 0 down">+4</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7109_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7109XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7109_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7109_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7109XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7109_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7109#respond" onclick="return addComment.moveForm(&quot;comment-7109&quot;, &quot;7109&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-19268"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/5bfa47f01c70feab4b88bc90183777af" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">J</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-19268"><span class="time-since">May 5, 2012</span></a></p></div><div class="comment-entry"><p>Don’t see the coherency.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_19268_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_19268_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX19268XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19268_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_19268_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX19268XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19268_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=19268#respond" onclick="return addComment.moveForm(&quot;comment-19268&quot;, &quot;19268&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-even depth-1" id="comment-7207"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/b78550e6b36ac16656cb6102820df157" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Fei</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7207"><span class="time-since">November 25, 2011</span></a></p></div><div class="comment-entry"><p>Using suffix tree can do this in O(n). And building suffix tree can be also done in O(n): <a href="http://blog.csdn.net/g9yuayon/article/details/2574781" rel="nofollow">http://blog.csdn.net/g9yuayon/article/details/2574781</a></p><p>But this algorithm is pretty cool too!</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7207_c" class="gdt-size-20 gdthumbtext"> <strong title="2 up, 0 down">+2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7207_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7207XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7207_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7207_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7207XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7207_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7207#respond" onclick="return addComment.moveForm(&quot;comment-7207&quot;, &quot;7207&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="comment-7487"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7487"><span class="time-since">November 29, 2011</span></a></p></div><div class="comment-entry"><p>Thanks Fei! I will look into that.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7487_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7487_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7487XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7487_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7487_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7487XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7487_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7487#respond" onclick="return addComment.moveForm(&quot;comment-7487&quot;, &quot;7487&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-7485"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/ac870bcae958b2183a34d2eb1321529f" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">LB</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7485"><span class="time-since">November 29, 2011</span></a></p></div><div class="comment-entry"><p>Clear explanation. It could hardly be any better <img src="./Manacher_Algorithm_files/icon_smile.gif" alt=":)" class="wp-smiley"></p><p>Thumbs up for elucidating this magic O(n) solution in such intuitive manner. You got talent to clearly expressing an algorithm, which I even missed in books like Cormen’s Algorithm!</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7485_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 0 down">+1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7485_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7485XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7485_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7485_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7485XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7485_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7485#respond" onclick="return addComment.moveForm(&quot;comment-7485&quot;, &quot;7485&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="comment-7486"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7486"><span class="time-since">November 29, 2011</span></a></p></div><div class="comment-entry"><p>Thanks! Good to know I’ve done my job — to introduce tricky but interesting algorithms in an intuitive manner.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7486_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 0 down">+1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7486_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7486XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7486_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7486_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7486XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7486_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7486#respond" onclick="return addComment.moveForm(&quot;comment-7486&quot;, &quot;7486&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment byuser comment-author-bahlulhaider even thread-even depth-1" id="comment-7650"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/bahlulhaider/" rel="nofollow"> <img src="./Manacher_Algorithm_files/ce81988c5949fe9ecf6fc931306461a8-bpthumb.jpg" alt="Avatar Image" class="avatar user-361-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/bahlulhaider/" rel="nofollow">Bahlul Haider</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-7650"><span class="time-since">December 1, 2011</span></a></p></div><div class="comment-entry"><p>Really beautiful algorithm.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_7650_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_7650_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX7650XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7650_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_7650_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX7650XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_7650_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=7650#respond" onclick="return addComment.moveForm(&quot;comment-7650&quot;, &quot;7650&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-8054"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/d85562740ba17bb6805a5186f447edce" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Googmeister</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-8054"><span class="time-since">December 6, 2011</span></a></p></div><div class="comment-entry"><p>Wonderful writeup with great illustrations! I think there is one minor bug in your code: if s itself is a palindrome, then the following line accesses the array out of bounds.</p><p></p><div id="crayon-53a668205d32a" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 13px !important; line-height: 16px !important; height: auto;"><div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 16px !important; z-index: 0; opacity: 0; overflow: hidden;">&nbsp;&nbsp;&nbsp;&nbsp;while (T[i + 1 + P[i]] == T[i - 1 - P[i]])</textarea></div><div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><table class="crayon-table" style="margin-left: -28px;"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-num" data-line="crayon-53a668205d32a-1">1</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-line" id="crayon-53a668205d32a-1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="st">while</span><span class="h"> </span><span class="sy">(</span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="sy">)</span></div></div></td></tr></tbody></table></div></div><p></p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_8054_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_8054_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX8054XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8054_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_8054_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX8054XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8054_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=8054#respond" onclick="return addComment.moveForm(&quot;comment-8054&quot;, &quot;8054&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor even depth-2" id="comment-8085"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-8085"><span class="time-since">December 6, 2011</span></a></p></div><div class="comment-entry"><p>ahh… you are right! Thanks for your sharp observation.</p><p>I thought that I feel something is not right when I decided to add ‘$’ both to the begin and the end of the input string. (It should be adding two different sentinels ‘^’ and ‘$’ to the begin and the end of the string. This should avoid bounds checking and the out of bounds problem)</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_8085_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_8085_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX8085XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8085_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_8085_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX8085XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8085_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=8085#respond" onclick="return addComment.moveForm(&quot;comment-8085&quot;, &quot;8085&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt depth-2" id="comment-128100"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/153ffcdc0c1af218934115405798c3b2" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">online chesstle</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-128100"><span class="time-since">February 15, 2014</span></a></p></div><div class="comment-entry"><p>s.substr((centerIndex – 1 – maxLen)/2, maxLen); is there a  bug here as the rest of the code is treating P[i] as the  length of the palindrome on either side of the center and not as the total length of the palindrome.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_128100_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_128100_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX128100XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128100_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_128100_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX128100XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128100_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=128100#respond" onclick="return addComment.moveForm(&quot;comment-128100&quot;, &quot;128100&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even depth-2" id="comment-128104"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/153ffcdc0c1af218934115405798c3b2" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">online chesstle</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-128104"><span class="time-since">February 15, 2014</span></a></p></div><div class="comment-entry"><p>a fault in the code here? s.substr((centerIndex – 1 – maxLen)/2, maxLen);</p><p>the core algortihm  is handling P[i] as the  length of the palindrome on either side of the center and not as the total length of the palindrome.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_128104_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_128104_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX128104XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128104_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_128104_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX128104XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128104_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=128104#respond" onclick="return addComment.moveForm(&quot;comment-128104&quot;, &quot;128104&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-3" id="comment-128106"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/153ffcdc0c1af218934115405798c3b2" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">online chesstle</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-128106"><span class="time-since">February 15, 2014</span></a></p></div><div class="comment-entry"><p>nevermind, accounting for the hashes.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_128106_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_128106_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX128106XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128106_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_128106_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX128106XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128106_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=128106#respond" onclick="return addComment.moveForm(&quot;comment-128106&quot;, &quot;128106&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li></ul></li><li class="comment even thread-even depth-1" id="comment-8590"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/de7707a1f1ca08c9eeafa635663e4c25" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Karthick</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-8590"><span class="time-since">December 12, 2011</span></a></p></div><div class="comment-entry"><p>Thanks for such a lucid explanation. I had already visited all the references that you had suggested at the end. I was not able to understand the essence of it until I read yours. <img src="./Manacher_Algorithm_files/icon_smile.gif" alt=":)" class="wp-smiley"></p><p>Well, I have one question.<br> Is it possible to run the algorithm without using the ‘#’,'^’,'$’ symbols?</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_8590_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_8590_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX8590XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8590_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_8590_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX8590XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8590_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=8590#respond" onclick="return addComment.moveForm(&quot;comment-8590&quot;, &quot;8590&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-karthick odd alt depth-2" id="comment-8594"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/karthick/" rel="nofollow"> <img src="./Manacher_Algorithm_files/de7707a1f1ca08c9eeafa635663e4c25(1)" alt="Avatar Image" class="avatar user-406-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/karthick/" rel="nofollow">Karthick</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-8594"><span class="time-since">December 12, 2011</span></a></p></div><div class="comment-entry"><p>As an after-thought, I have one doubt.<br> Why are we using the line<br> P[i] = (R &gt; i) ? min(R-i, P[i_mirror]) : 0;</p><p>Can you please clarify this?</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_8594_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_8594_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX8594XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8594_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_8594_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX8594XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_8594_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=8594#respond" onclick="return addComment.moveForm(&quot;comment-8594&quot;, &quot;8594&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment byuser comment-author-yjyongz even thread-odd thread-alt depth-1" id="comment-13131"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/yjyongz/" rel="nofollow"> <img src="./Manacher_Algorithm_files/158c1b6c232eacd6ea5ab3b7b9d29bbc" alt="Avatar Image" class="avatar user-30-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/yjyongz/" rel="nofollow">MSJ</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-13131"><span class="time-since">January 22, 2012</span></a></p></div><div class="comment-entry"><p>there are another two solutions<br> 1) suffix array version preprocess requires N*logN query is O(N) <a href="http://www.mashengjun.info/?p=901" rel="nofollow">http://www.mashengjun.info/?p=901</a><br> 2) another O(N) solution <a href="http://www.mashengjun.info/?p=464" rel="nofollow">http://www.mashengjun.info/?p=464</a> using up&amp;down pointer</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_13131_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_13131_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX13131XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_13131_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_13131_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX13131XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_13131_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=13131#respond" onclick="return addComment.moveForm(&quot;comment-13131&quot;, &quot;13131&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="comment-13142"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/admin/" rel="nofollow"> <img src="./Manacher_Algorithm_files/2ffa5b26dd039dec008aa06ddae07ec0-bpthumb.jpg" alt="Avatar Image" class="avatar user-8268-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/admin/" rel="nofollow">1337c0d3r</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-13142"><span class="time-since">January 22, 2012</span></a></p></div><div class="comment-entry"><p>Did you try running your code through Online Judge? <a href="http://www.leetcode.com/onlinejudge" rel="nofollow">http://www.leetcode.com/onlinejudge</a><br> It did not pass all test cases.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_13142_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_13142_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX13142XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_13142_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_13142_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX13142XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_13142_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=13142#respond" onclick="return addComment.moveForm(&quot;comment-13142&quot;, &quot;13142&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even depth-2" id="comment-15770"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/cc7c39630599dcaa53f5c4c01f1aa169" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">caopeng</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-15770"><span class="time-since">March 2, 2012</span></a></p></div><div class="comment-entry"><p>The seconde is not O(N) it’s O(N^2) i think…</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_15770_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_15770_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX15770XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_15770_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_15770_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX15770XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_15770_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=15770#respond" onclick="return addComment.moveForm(&quot;comment-15770&quot;, &quot;15770&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment byuser comment-author-cpcs odd alt thread-even depth-1" id="comment-15749"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/cpcs/" rel="nofollow"> <img src="./Manacher_Algorithm_files/cc7c39630599dcaa53f5c4c01f1aa169(1)" alt="Avatar Image" class="avatar user-832-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/cpcs/" rel="nofollow">Caopeng</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-15749"><span class="time-since">March 1, 2012</span></a></p></div><div class="comment-entry"><p>The first i_mirror is -1 which is less than 0 so there may be run time error?</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_15749_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_15749_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX15749XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_15749_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_15749_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX15749XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_15749_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=15749#respond" onclick="return addComment.moveForm(&quot;comment-15749&quot;, &quot;15749&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-16488"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/d27888294f6f841efc8be7e395e4d561" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Anonymous</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-16488"><span class="time-since">March 19, 2012</span></a></p></div><div class="comment-entry"><p></p><div id="crayon-53a668205cdb0" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 13px !important; line-height: 16px !important; height: auto;"><div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 16px !important; z-index: 0; opacity: 0; overflow: hidden;">while (T[i + 1 + P[i]] == T[i - 1 - P[i]])
P[i]++;</textarea></div><div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><table class="crayon-table" style="margin-left: -28px;"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-num" data-line="crayon-53a668205cdb0-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205cdb0-2">2</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-line" id="crayon-53a668205cdb0-1"><span class="st">while</span><span class="h"> </span><span class="sy">(</span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205cdb0-2"><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">++</span><span class="sy">;</span></div></div></td></tr></tbody></table></div></div><p></p><p>It’s really O(N)?</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_16488_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_16488_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX16488XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_16488_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_16488_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX16488XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_16488_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=16488#respond" onclick="return addComment.moveForm(&quot;comment-16488&quot;, &quot;16488&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-even depth-1" id="comment-18023"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/fd3c2d03d5b56fe232f16e69f9fd5ad2" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Vyas</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-18023"><span class="time-since">April 9, 2012</span></a></p></div><div class="comment-entry"><p>A Very nice explanation!!!!:)<br> One thing I could not understand… “In this case, since P[ 21 ] ≠ P[ 1 ], we conclude that P[ i ] = 5.”.. In this statement, from what I have understood, I think it should be P[21] ≠ P[8]. Please correct me if I’m wrong…..</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_18023_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_18023_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX18023XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_18023_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_18023_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX18023XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_18023_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=18023#respond" onclick="return addComment.moveForm(&quot;comment-18023&quot;, &quot;18023&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-19014"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/5ea8b79eb76a361e95456cf0ccc7034e" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Kareem</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-19014"><span class="time-since">May 1, 2012</span></a></p></div><div class="comment-entry"><p>The conclusion of the algorithm above states that<br> if P[ i' ] ≤ R – i,<br> then P[ i ] ← P[ i' ]<br> else P[ i ] ≥ P[ i' ]. (Which we have to expand past the right edge (R) to find P[ i ].</p><p>The first check should be P[ i' ] &lt; R – i, as when they are equal the proper value of p[i] can not be fully determined with P[ i' ] only but needs to expand.<br> for example: string #b#b#a#b#a#b#a# with i = 9, c = 7, R = 12</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_19014_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_19014_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX19014XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19014_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_19014_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX19014XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19014_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=19014#respond" onclick="return addComment.moveForm(&quot;comment-19014&quot;, &quot;19014&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-23196"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/e48017a2a74ba97f653969668a4adeb4" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Li</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-23196"><span class="time-since">August 2, 2012</span></a></p></div><div class="comment-entry"><p>Agree with you.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_23196_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_23196_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX23196XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_23196_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_23196_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX23196XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_23196_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=23196#respond" onclick="return addComment.moveForm(&quot;comment-23196&quot;, &quot;23196&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-even depth-1" id="comment-19266"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/5bfa47f01c70feab4b88bc90183777af(1)" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">J</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-19266"><span class="time-since">May 5, 2012</span></a></p></div><div class="comment-entry"><p>It is clear that the two substrings in the region indicated by the two solid green lines must match exactly. Areas across the center (indicated by dotted green lines) must also be symmetric.</p><p>i is in green area (index 15). So I should have the same value as i[7]. but it doesn’t.</p><p>So what is going on?</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_19266_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_19266_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX19266XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19266_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_19266_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX19266XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19266_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=19266#respond" onclick="return addComment.moveForm(&quot;comment-19266&quot;, &quot;19266&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-19267"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/5bfa47f01c70feab4b88bc90183777af" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">J</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-19267"><span class="time-since">May 5, 2012</span></a></p></div><div class="comment-entry"><p>The first two lines are quotes from the written explanation.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_19267_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_19267_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX19267XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19267_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_19267_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX19267XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_19267_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=19267#respond" onclick="return addComment.moveForm(&quot;comment-19267&quot;, &quot;19267&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-20365"><div class="comment-avatar-box"><div class="avb"> <a href="http://codeinterview.blogspot.com/" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/753cd47bd083821b52b44816f8a5feb3" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://codeinterview.blogspot.com/" rel="nofollow">Chev</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-20365"><span class="time-since">May 27, 2012</span></a></p></div><div class="comment-entry"><p>Is there a problem in the following code? i_mirror will be -1 and P[i_mirror] will be out of boundary when C=0 and i =1, or do I miss something? Thanks.<br> …<br> int C = 0, R = 0;<br> for (int i = 1; i  i) ? min(R-i, P[i_mirror]) : 0;<br> …<br> }</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_20365_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_20365_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX20365XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20365_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_20365_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX20365XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20365_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=20365#respond" onclick="return addComment.moveForm(&quot;comment-20365&quot;, &quot;20365&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-20367"><div class="comment-avatar-box"><div class="avb"> <a href="http://codeinterview.blogspot.com/" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/753cd47bd083821b52b44816f8a5feb3(1)" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://codeinterview.blogspot.com/" rel="nofollow">Chev</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-20367"><span class="time-since">May 27, 2012</span></a></p></div><div class="comment-entry"><p>I see! It is my mistake. Thanks!</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_20367_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_20367_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX20367XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20367_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_20367_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX20367XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20367_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=20367#respond" onclick="return addComment.moveForm(&quot;comment-20367&quot;, &quot;20367&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-even depth-1" id="comment-20366"><div class="comment-avatar-box"><div class="avb"> <a href="http://codeinterview.blogspot.com/" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/753cd47bd083821b52b44816f8a5feb3" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://codeinterview.blogspot.com/" rel="nofollow">Chev</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-20366"><span class="time-since">May 27, 2012</span></a></p></div><div class="comment-entry"><p>Here is the piece of code where I am confused:<br> int C = 0, R = 0;<br> for (int i = 1; i  i) ? min(R-i, P[i_mirror]) : 0;</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_20366_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_20366_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX20366XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20366_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_20366_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX20366XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20366_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=20366#respond" onclick="return addComment.moveForm(&quot;comment-20366&quot;, &quot;20366&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-20368"><div class="comment-avatar-box"><div class="avb"> <a href="http://codeinterview.blogspot.com/" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/753cd47bd083821b52b44816f8a5feb3(1)" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://codeinterview.blogspot.com/" rel="nofollow">Chev</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-20368"><span class="time-since">May 27, 2012</span></a></p></div><div class="comment-entry"><p>Got it! I am clear now. Thanks!</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_20368_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_20368_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX20368XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20368_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_20368_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX20368XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_20368_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=20368#respond" onclick="return addComment.moveForm(&quot;comment-20368&quot;, &quot;20368&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-22161"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/e0542505c6ec76d6dc78f73779433b43" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Chuanyou Li</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-22161"><span class="time-since">July 6, 2012</span></a></p></div><div class="comment-entry"><p>Should P[i]  R – i ??</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_22161_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_22161_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX22161XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_22161_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_22161_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX22161XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_22161_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=22161#respond" onclick="return addComment.moveForm(&quot;comment-22161&quot;, &quot;22161&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-even depth-1" id="comment-24896"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/bc4124a53564f9049d3e88e60c913c14" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Noone</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-24896"><span class="time-since">September 5, 2012</span></a></p></div><div class="comment-entry"><p>Have to disagree with the others. You have actually managed to complicate a simple algorithm!</p><p>The key idea is quite simple actually.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_24896_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_24896_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX24896XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_24896_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_24896_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX24896XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_24896_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=24896#respond" onclick="return addComment.moveForm(&quot;comment-24896&quot;, &quot;24896&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-27096"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/522cfe0f3f3c90854067a62da3b6982c" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Subramanian Ganapathy</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-27096"><span class="time-since">October 14, 2012</span></a></p></div><div class="comment-entry"><p>Recurrence:</p><p>L[i] = max{L[i-1] + 1, #Arr[i-1 - L[i-1]…i] is univalue.<br> L[i-1]+2 #Arr[i] == Arr[i-1-L[i-1]]}<br> L[i]=1 otherwise.</p><p>Am i missing something here? this recurrrence solves it and it is a lot simpler.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_27096_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_27096_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX27096XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_27096_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_27096_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX27096XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_27096_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=27096#respond" onclick="return addComment.moveForm(&quot;comment-27096&quot;, &quot;27096&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-27099"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/522cfe0f3f3c90854067a62da3b6982c(1)" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Subramanian Ganapathy</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-27099"><span class="time-since">October 14, 2012</span></a></p></div><div class="comment-entry"><p>My bad <img src="./Manacher_Algorithm_files/icon_smile.gif" alt=":)" class="wp-smiley"> my recurrence messes up the overlapping palindromes case, awesome solution and nice explanation. you deserve a pat on your back <img src="./Manacher_Algorithm_files/icon_smile.gif" alt=":)" class="wp-smiley"> thank you</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_27099_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_27099_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX27099XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_27099_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_27099_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX27099XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_27099_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=27099#respond" onclick="return addComment.moveForm(&quot;comment-27099&quot;, &quot;27099&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-even depth-1" id="comment-28654"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/119ab5c73b7b666dfd49823cbdaa6e52" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Karthick</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-28654"><span class="time-since">November 1, 2012</span></a></p></div><div class="comment-entry"><p>The following is the implementation of the Manacher’s algorithm without pre-processing the input string. It is a bit clumsy – sorry for that. I tested it using the online judge here and it seems to be working fine.</p><p>Language : java</p><div id="crayon-53a668205c53d" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 13px !important; line-height: 16px !important; height: auto;"><div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 16px !important; z-index: 0; opacity: 0; overflow: hidden;">    public String longestPalindrome(String s) {
        if(s==null)
            return "";
            
        int len=s.length();
        int[] p=new int[2*len-1];
        p[0]=1;
        int R=0,C=0;
        int curLen,l,r,start;

        for(int i=1;ii) ? Math.min(curLen,p[iMirror]) : ( i%2==0 ? 1 : 0) );
            if(i%2==0){
                l=(i/2-p[i]/2-1);
                r=(i/2+p[i]/2+1);
            }
            else{
                l=(i/2-p[i]/2);
                r=(i/2+p[i]/2+1);
            }
            
            while(l&gt;=0 &amp;&amp; rR){
                C=i;
                R=r-1;
            } 
        }
        
        int maxIndex=getMaxIndex(p);
        if(maxIndex%2==0)
            start=(maxIndex/2-p[maxIndex]/2);
        else
            start=(maxIndex/2-p[maxIndex]/2 +1);
        
        return s.substring(start,start+p[maxIndex]);
            
    }
    
    int getMaxIndex(int p[]){
        int len=p.length;
        int maxIndex=0;
        for(int i=1;ip[maxIndex])
                maxIndex=i;
        }
        return maxIndex;
    }</textarea></div><div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><table class="crayon-table" style="margin-left: -28px;"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-num" data-line="crayon-53a668205c53d-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-2">2</div><div class="crayon-num" data-line="crayon-53a668205c53d-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-4">4</div><div class="crayon-num" data-line="crayon-53a668205c53d-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-6">6</div><div class="crayon-num" data-line="crayon-53a668205c53d-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-8">8</div><div class="crayon-num" data-line="crayon-53a668205c53d-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-10">10</div><div class="crayon-num" data-line="crayon-53a668205c53d-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-12">12</div><div class="crayon-num" data-line="crayon-53a668205c53d-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-14">14</div><div class="crayon-num" data-line="crayon-53a668205c53d-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-16">16</div><div class="crayon-num" data-line="crayon-53a668205c53d-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-18">18</div><div class="crayon-num" data-line="crayon-53a668205c53d-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-20">20</div><div class="crayon-num" data-line="crayon-53a668205c53d-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-22">22</div><div class="crayon-num" data-line="crayon-53a668205c53d-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-24">24</div><div class="crayon-num" data-line="crayon-53a668205c53d-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-26">26</div><div class="crayon-num" data-line="crayon-53a668205c53d-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-28">28</div><div class="crayon-num" data-line="crayon-53a668205c53d-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-30">30</div><div class="crayon-num" data-line="crayon-53a668205c53d-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-32">32</div><div class="crayon-num" data-line="crayon-53a668205c53d-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-34">34</div><div class="crayon-num" data-line="crayon-53a668205c53d-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-36">36</div><div class="crayon-num" data-line="crayon-53a668205c53d-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-38">38</div><div class="crayon-num" data-line="crayon-53a668205c53d-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-40">40</div><div class="crayon-num" data-line="crayon-53a668205c53d-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-42">42</div><div class="crayon-num" data-line="crayon-53a668205c53d-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205c53d-44">44</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-line" id="crayon-53a668205c53d-1"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="m">public</span><span class="h"> </span><span class="t">String</span><span class="h"> </span><span class="e">longestPalindrome</span><span class="sy">(</span><span class="t">String</span><span class="h"> </span><span class="i">s</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-2"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">if</span><span class="sy">(</span><span class="v">s</span><span class="o">==</span><span class="t">null</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53a668205c53d-3"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">return</span><span class="h"> </span><span class="s">""</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-4"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a668205c53d-5"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">len</span><span class="o">=</span><span class="v">s</span><span class="sy">.</span><span class="e">length</span><span class="sy">(</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-6"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="sy">[</span><span class="sy">]</span><span class="h"> </span><span class="v">p</span><span class="o">=</span><span class="r">new</span><span class="h"> </span><span class="t">int</span><span class="sy">[</span><span class="cn">2</span><span class="o">*</span><span class="i">len</span><span class="o">-</span><span class="cn">1</span><span class="sy">]</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a668205c53d-7"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">p</span><span class="sy">[</span><span class="cn">0</span><span class="sy">]</span><span class="o">=</span><span class="cn">1</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-8"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">R</span><span class="o">=</span><span class="cn">0</span><span class="sy">,</span><span class="v">C</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a668205c53d-9"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="i">curLen</span><span class="sy">,</span><span class="i">l</span><span class="sy">,</span><span class="i">r</span><span class="sy">,</span><span class="i">start</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-10">&nbsp;</div><div class="crayon-line" id="crayon-53a668205c53d-11"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">for</span><span class="sy">(</span><span class="t">int</span><span class="h"> </span><span class="v">i</span><span class="o">=</span><span class="cn">1</span><span class="sy">;</span><span class="i">ii</span><span class="sy">)</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="v">Math</span><span class="sy">.</span><span class="e">min</span><span class="sy">(</span><span class="i">curLen</span><span class="sy">,</span><span class="v">p</span><span class="sy">[</span><span class="i">iMirror</span><span class="sy">]</span><span class="sy">)</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="sy">(</span><span class="h"> </span><span class="i">i</span><span class="o">%</span><span class="cn">2</span><span class="o">==</span><span class="cn">0</span><span class="h"> </span><span class="sy">?</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">:</span><span class="h"> </span><span class="cn">0</span><span class="sy">)</span><span class="h"> </span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-12"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">if</span><span class="sy">(</span><span class="i">i</span><span class="o">%</span><span class="cn">2</span><span class="o">==</span><span class="cn">0</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53a668205c53d-13"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">l</span><span class="o">=</span><span class="sy">(</span><span class="i">i</span><span class="o">/</span><span class="cn">2</span><span class="o">-</span><span class="v">p</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">/</span><span class="cn">2</span><span class="o">-</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-14"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">r</span><span class="o">=</span><span class="sy">(</span><span class="i">i</span><span class="o">/</span><span class="cn">2</span><span class="o">+</span><span class="v">p</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">/</span><span class="cn">2</span><span class="o">+</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a668205c53d-15"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-16"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">else</span><span class="sy">{</span></div><div class="crayon-line" id="crayon-53a668205c53d-17"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">l</span><span class="o">=</span><span class="sy">(</span><span class="i">i</span><span class="o">/</span><span class="cn">2</span><span class="o">-</span><span class="v">p</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">/</span><span class="cn">2</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-18"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">r</span><span class="o">=</span><span class="sy">(</span><span class="i">i</span><span class="o">/</span><span class="cn">2</span><span class="o">+</span><span class="v">p</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">/</span><span class="cn">2</span><span class="o">+</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a668205c53d-19"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-20"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a668205c53d-21"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">while</span><span class="sy">(</span><span class="i">l</span><span class="o">&gt;=</span><span class="cn">0</span><span class="h"> </span><span class="o">&amp;&amp;</span><span class="h"> </span><span class="i">rR</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-22"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">C</span><span class="o">=</span><span class="i">i</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a668205c53d-23"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">R</span><span class="o">=</span><span class="i">r</span><span class="o">-</span><span class="cn">1</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-24"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span><span class="h"> </span></div><div class="crayon-line" id="crayon-53a668205c53d-25"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-26"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a668205c53d-27"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">maxIndex</span><span class="o">=</span><span class="e">getMaxIndex</span><span class="sy">(</span><span class="i">p</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-28"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">if</span><span class="sy">(</span><span class="i">maxIndex</span><span class="o">%</span><span class="cn">2</span><span class="o">==</span><span class="cn">0</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53a668205c53d-29"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">start</span><span class="o">=</span><span class="sy">(</span><span class="i">maxIndex</span><span class="o">/</span><span class="cn">2</span><span class="o">-</span><span class="v">p</span><span class="sy">[</span><span class="i">maxIndex</span><span class="sy">]</span><span class="o">/</span><span class="cn">2</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-30"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">else</span></div><div class="crayon-line" id="crayon-53a668205c53d-31"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">start</span><span class="o">=</span><span class="sy">(</span><span class="i">maxIndex</span><span class="o">/</span><span class="cn">2</span><span class="o">-</span><span class="v">p</span><span class="sy">[</span><span class="i">maxIndex</span><span class="sy">]</span><span class="o">/</span><span class="cn">2</span><span class="h"> </span><span class="o">+</span><span class="cn">1</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-32"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a668205c53d-33"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">return</span><span class="h"> </span><span class="v">s</span><span class="sy">.</span><span class="e">substring</span><span class="sy">(</span><span class="i">start</span><span class="sy">,</span><span class="i">start</span><span class="o">+</span><span class="v">p</span><span class="sy">[</span><span class="i">maxIndex</span><span class="sy">]</span><span class="sy">)</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-34"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a668205c53d-35"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-36"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-53a668205c53d-37"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="e">getMaxIndex</span><span class="sy">(</span><span class="t">int</span><span class="h"> </span><span class="v">p</span><span class="sy">[</span><span class="sy">]</span><span class="sy">)</span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-38"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">len</span><span class="o">=</span><span class="v">p</span><span class="sy">.</span><span class="i">length</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a668205c53d-39"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="t">int</span><span class="h"> </span><span class="v">maxIndex</span><span class="o">=</span><span class="cn">0</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-40"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">for</span><span class="sy">(</span><span class="t">int</span><span class="h"> </span><span class="v">i</span><span class="o">=</span><span class="cn">1</span><span class="sy">;</span><span class="v">ip</span><span class="sy">[</span><span class="i">maxIndex</span><span class="sy">]</span><span class="sy">)</span></div><div class="crayon-line" id="crayon-53a668205c53d-41"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">maxIndex</span><span class="o">=</span><span class="i">i</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-42"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div><div class="crayon-line" id="crayon-53a668205c53d-43"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="st">return</span><span class="h"> </span><span class="i">maxIndex</span><span class="sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205c53d-44"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div></div></td></tr></tbody></table></div></div><p></p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_28654_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 2 down">-2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_28654_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX28654XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_28654_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_28654_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX28654XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_28654_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=28654#respond" onclick="return addComment.moveForm(&quot;comment-28654&quot;, &quot;28654&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-28655"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/119ab5c73b7b666dfd49823cbdaa6e52(1)" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Karthick</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-28655"><span class="time-since">November 1, 2012</span></a></p></div><div class="comment-entry"><p>Sorry,there seems to be some problem – some part of the code seems to be omitted  when I post my code using the</p><div id="crayon-53a668205c36f" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 13px !important; line-height: 16px !important; height: auto;"><div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 16px !important; z-index: 0; opacity: 0; overflow: hidden;"></textarea></div><div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><table class="crayon-table" style="margin-left: -28px;"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-num" data-line="crayon-53a668205c36f-1">1</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-line" id="crayon-53a668205c36f-1">&nbsp;</div></div></td></tr></tbody></table></div></div><p> tag. So, I am posting it without the code tag.</p><p>public String longestPalindrome(String s) {</p><p> if(s==null)<br> return “”;</p><p> int len=s.length();<br> int[] p=new int[2*len-1];<br> p[0]=1;<br> int R=0,C=0;<br> int curLen,l,r,start;<br> for(int i=1;ii) ? Math.min(curLen,p[iMirror]) : ( i%2==0 ? 1 : 0) );<br> if(i%2==0){<br> l=(i/2-p[i]/2-1);<br> r=(i/2+p[i]/2+1);<br> }<br> else{<br> l=(i/2-p[i]/2);<br> r=(i/2+p[i]/2+1);<br> }</p><p> while(l&gt;=0 &amp;&amp; rR){<br> C=i;<br> R=r-1;<br> }</p><p> }</p><p> int maxIndex=getMaxIndex(p);<br> if(maxIndex%2==0)<br> start=(maxIndex/2-p[maxIndex]/2);<br> else<br> start=(maxIndex/2-p[maxIndex]/2 +1);</p><p> return s.substring(start,start+p[maxIndex]);</p><p> }</p><p> int getMaxIndex(int p[]){<br> int len=p.length;<br> int maxIndex=0;<br> for(int i=1;ip[maxIndex])<br> maxIndex=i;<br> }<br> return maxIndex;<br> }</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_28655_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_28655_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX28655XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_28655_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_28655_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX28655XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_28655_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=28655#respond" onclick="return addComment.moveForm(&quot;comment-28655&quot;, &quot;28655&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment even thread-odd thread-alt depth-1" id="comment-34715"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/25db023c216c986b0c90024dce1d9270" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">abhay</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-34715"><span class="time-since">January 5, 2013</span></a></p></div><div class="comment-entry"><p>nice explaination thanks for article..<br> <img src="./Manacher_Algorithm_files/icon_razz.gif" alt=":P" class="wp-smiley"></p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_34715_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_34715_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX34715XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_34715_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_34715_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX34715XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_34715_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=34715#respond" onclick="return addComment.moveForm(&quot;comment-34715&quot;, &quot;34715&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-even depth-1" id="comment-36073"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/96e45efcdaa8c34d570238c6f25557e2" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Naveen Kumar</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-36073"><span class="time-since">January 16, 2013</span></a></p></div><div class="comment-entry"><p>I am stuck at summarized part of this algo.<br> if P[ i' ] ≤ R – i,<br> then P[ i ] ← P[ i' ]<br> else P[ i ] ≥ P[ i' ]. (Which we have to expand past the right edge (R) to find P[ i ].)<br> how could we say which one be large for else part.?<br> even in example for i=15,p[i]=5,i’=7 p[i']=7;<br> i m confused here. plz help me.<br> Thanks..</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_36073_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_36073_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX36073XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_36073_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_36073_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX36073XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_36073_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=36073#respond" onclick="return addComment.moveForm(&quot;comment-36073&quot;, &quot;36073&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-monysimkh even thread-odd thread-alt depth-1" id="comment-36537"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/monysimkh/" rel="nofollow"> <img src="./Manacher_Algorithm_files/1ccd1ec73148ccff38924ed01b27d643-bpthumb.jpg" alt="Avatar Image" class="avatar user-5026-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/monysimkh/" rel="nofollow">Mony Sim</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-36537"><span class="time-since">January 20, 2013</span></a></p></div><div class="comment-entry"><p>try simple solution.<br> bool is palindrome(string s)<br> { int len=s.length(), a=0, b=len-1;<br> while(a&lt;b)<br> {<br> if(s[a]!=s[b])<br> return false;<br> }<br> return true;<br> }</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_36537_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 2 down">-2</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_36537_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX36537XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_36537_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_36537_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX36537XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_36537_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=36537#respond" onclick="return addComment.moveForm(&quot;comment-36537&quot;, &quot;36537&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-monysimkh odd alt thread-even depth-1" id="comment-36542"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/monysimkh/" rel="nofollow"> <img src="./Manacher_Algorithm_files/1ccd1ec73148ccff38924ed01b27d643-bpthumb.jpg" alt="Avatar Image" class="avatar user-5026-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/monysimkh/" rel="nofollow">Mony Sim</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-36542"><span class="time-since">January 20, 2013</span></a></p></div><div class="comment-entry"><p>try simple solution.<br> bool is palindrome(string s)<br> { int len=s.length(), a=0, b=len-1;<br> while(a&lt;b)<br> {<br> if(s[++a]!=s[--b])<br> return false;<br> }<br> return true;<br> }</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_36542_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_36542_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX36542XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_36542_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_36542_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX36542XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_36542_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=36542#respond" onclick="return addComment.moveForm(&quot;comment-36542&quot;, &quot;36542&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-odd thread-alt depth-1" id="comment-39190"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/40bd62f2ec0d330baf7174a1b4bf0de7" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">rajat rastogi</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-39190"><span class="time-since">February 2, 2013</span></a></p></div><div class="comment-entry"><p>Dude your solution is O(n^2) take a case of a string aaaaaa, palindrome length is 6 and solution for this string confirms O(n^2)</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_39190_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_39190_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX39190XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_39190_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_39190_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX39190XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_39190_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=39190#respond" onclick="return addComment.moveForm(&quot;comment-39190&quot;, &quot;39190&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-gyosh odd alt depth-2" id="comment-55174"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/gyosh/" rel="nofollow"> <img src="./Manacher_Algorithm_files/c070c77df63240699f89a207bcbb4fd0" alt="Avatar Image" class="avatar user-11287-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/gyosh/" rel="nofollow">William Gozali</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-55174"><span class="time-since">April 14, 2013</span></a></p></div><div class="comment-entry"><p>I don’t think so.</p><p>Take a look at the explanation, it is guaranteed that the operation needed will not exceed O(N). Maybe you should try to simulate the algorithm with that input</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_55174_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_55174_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX55174XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_55174_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_55174_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX55174XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_55174_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=55174#respond" onclick="return addComment.moveForm(&quot;comment-55174&quot;, &quot;55174&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment byuser comment-author-lakerka even thread-even depth-1" id="comment-39618"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/lakerka/" rel="nofollow"> <img src="./Manacher_Algorithm_files/5d86bc03b5da54068f8dc1714dce677a" alt="Avatar Image" class="avatar user-7264-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/lakerka/" rel="nofollow">Žilvinas</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-39618"><span class="time-since">February 4, 2013</span></a></p></div><div class="comment-entry"><p>Thanks so much, exelent tutorial!</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_39618_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_39618_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX39618XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_39618_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_39618_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX39618XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_39618_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=39618#respond" onclick="return addComment.moveForm(&quot;comment-39618&quot;, &quot;39618&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-40258"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/31cc5fcfe458339422f00edf41e464a6" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Nipun Poddar</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-40258"><span class="time-since">February 6, 2013</span></a></p></div><div class="comment-entry"><p>really nice one..helpedme to learn a lot.. <img src="./Manacher_Algorithm_files/icon_smile.gif" alt=":)" class="wp-smiley"></p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_40258_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_40258_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX40258XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_40258_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_40258_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX40258XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_40258_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=40258#respond" onclick="return addComment.moveForm(&quot;comment-40258&quot;, &quot;40258&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-kuldeep even thread-even depth-1" id="comment-48482"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/kuldeep/" rel="nofollow"> <img src="./Manacher_Algorithm_files/790ff341bc505d28674f946249601e72-bpthumb.jpg" alt="Avatar Image" class="avatar user-8626-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/kuldeep/" rel="nofollow">Kuldeep Yadav</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-48482"><span class="time-since">March 15, 2013</span></a></p></div><div class="comment-entry"><p>GOOD WORK <img src="./Manacher_Algorithm_files/icon_smile.gif" alt=":)" class="wp-smiley"></p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_48482_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_48482_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX48482XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_48482_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_48482_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX48482XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_48482_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=48482#respond" onclick="return addComment.moveForm(&quot;comment-48482&quot;, &quot;48482&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-ayaskswain odd alt thread-odd thread-alt depth-1" id="comment-57589"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/ayaskswain/" rel="nofollow"> <img src="./Manacher_Algorithm_files/47c13b00010678acdbffbf46ead61294" alt="Avatar Image" class="avatar user-12024-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/ayaskswain/" rel="nofollow">Ayaskant Swain</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-57589"><span class="time-since">April 25, 2013</span></a></p></div><div class="comment-entry"><p>Wonderful post. Thanks for posting these kind of problems and their solutions which will help in interviews. I have a question in this part-II  solution.</p><p>I think the complexity will be still O(n * n), since you are traversing the string twice actually. One for modifying the original input string to insert characters ^,#,$ and then again you will do another traversal from the beginning to end of the string to search for actual palindromes in the string.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_57589_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_57589_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX57589XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_57589_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_57589_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX57589XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_57589_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=57589#respond" onclick="return addComment.moveForm(&quot;comment-57589&quot;, &quot;57589&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-62039"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/7815c42863f17401918af9b1343d4b51" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">lagrange</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-62039"><span class="time-since">June 2, 2013</span></a></p></div><div class="comment-entry"><p>我觉得那个中文的blog, p[i]表示向左/右延展的长度, 比p[i]表示整个substr的长度要更容易理解一些</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_62039_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_62039_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX62039XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_62039_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_62039_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX62039XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_62039_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=62039#respond" onclick="return addComment.moveForm(&quot;comment-62039&quot;, &quot;62039&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-63812"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/d98fbf355c908b12592f52dc0bfbd029" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">shivali</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-63812"><span class="time-since">June 17, 2013</span></a></p></div><div class="comment-entry"><p>can you please xplain how you calculated the complexity of the above algorithm</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_63812_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_63812_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX63812XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_63812_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_63812_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX63812XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_63812_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=63812#respond" onclick="return addComment.moveForm(&quot;comment-63812&quot;, &quot;63812&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-63865"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/d98fbf355c908b12592f52dc0bfbd029" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">shivali</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-63865"><span class="time-since">June 18, 2013</span></a></p></div><div class="comment-entry"><p>//longest pallindrome in a string(c++)<br> #include<br> #include<br> #define lsfor(i,a,b) for(i=a;i&lt;b;i++)</p><p>using namespace std;<br> char str[100];<br> int n,curr_len=0,max_len=1,l,r,t;</p><p>int main()<br> {<br> int i;<br> cout&lt;&lt;"enter no.of test cases:"&lt;&gt;t;<br> while(t–)<br> {<br> cout&lt;&lt;"please enter your string"&lt;&gt;str;<br> n=strlen(str);<br> if(n==1)<br> {cout&lt;&lt;"1"&lt;&lt;endl;<br> return(0);}</p><p> if(n==2)</p><p> {cout&lt;&lt;"2"&lt;=0&amp;&amp;r&lt;=n-1)<br> {<br> if(str[l]==str[r])<br> {<br> curr_len+=2;<br> if(max_len&lt;curr_len)<br> max_len=curr_len;<br> l–,r++;<br> }</p><p> else<br> break;<br> }<br> }<br> if(curr_len==1)<br> cout&lt;&lt;"sorry no palindrome"&lt;&lt;endl;<br> else<br> cout&lt;&lt;max_len&lt;&lt;endl;<br> }<br> return(0);</p><p>}</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_63865_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_63865_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX63865XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_63865_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_63865_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX63865XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_63865_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=63865#respond" onclick="return addComment.moveForm(&quot;comment-63865&quot;, &quot;63865&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment odd alt depth-2" id="comment-63866"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/d98fbf355c908b12592f52dc0bfbd029(1)" class="avatar avatar-25 photo" height="25" width="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">shivali</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-63866"><span class="time-since">June 18, 2013</span></a></p></div><div class="comment-entry"><p>//edited://longest pa<br> #include<br> #include<br> #define lsfor(i,a,b) for(i=a;i&lt;b;i++)</p><p>using namespace std;<br> char str[100];<br> int n,curr_len=0,max_len=1,l,r,t;</p><p>int main()<br> {<br> int i;<br> cout&lt;&lt;"enter no.of test cases:"&lt;&gt;t;<br> while(t–)<br> {<br> cout&lt;&lt;"please enter your string"&lt;&gt;str;<br> n=strlen(str);<br> if(n==1)<br> {cout&lt;&lt;"1"&lt;&lt;endl;<br> return(0);}</p><p> if(n==2)</p><p> {cout&lt;&lt;"2"&lt;=0&amp;&amp;r&lt;=n-1)<br> {<br> if(str[l]==str[r])<br> {<br> curr_len+=2;<br> if(max_len&lt;curr_len)<br> max_len=curr_len;<br> l–,r++;<br> }</p><p> else<br> break;<br> }<br> }<br> if(max_len==1)<br> cout&lt;&lt;"sorry no palindrome"&lt;&lt;endl;<br> else<br> cout&lt;&lt;max_len&lt;&lt;endl;<br> }<br> return(0);</p><p>}</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_63866_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_63866_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX63866XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_63866_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_63866_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX63866XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_63866_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=63866#respond" onclick="return addComment.moveForm(&quot;comment-63866&quot;, &quot;63866&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment byuser comment-author-jackyhou even thread-odd thread-alt depth-1" id="comment-66063"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/jackyhou/" rel="nofollow"> <img src="./Manacher_Algorithm_files/cc0bebf96abaf1523cdab65bec15adfc" alt="Avatar Image" class="avatar user-16186-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/jackyhou/" rel="nofollow">jackyhou</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-66063"><span class="time-since">July 3, 2013</span></a></p></div><div class="comment-entry"><p>int find_long_palindrome_line(char * str,char *substr)<br> {<br> if(str==NULL)<br> return -1;</p><p> int len=strlen(str);<br> if(len==0)<br> return 1;</p><p> int i=0;<br> int j=len-1;<br> int end = len-1;<br> int curindex=0;</p><p> int tmp_len=len*2+1;<br> char * tmp_allstr=(char *)malloc(sizeof(char)*(tmp_len));<br> int *i_arr=(int *)malloc(sizeof(int)*(tmp_len));</p><p> int index4_tmp_allstr=0;<br> for(int i=0;i&lt;len;i++)<br> {<br> tmp_allstr[index4_tmp_allstr++]='#';<br> tmp_allstr[index4_tmp_allstr++]=str[i];<br> }<br> tmp_allstr[index4_tmp_allstr]='#';</p><p> memset(i_arr,0,sizeof(int)*(tmp_len));</p><p> for(int i=2;i0 &amp;&amp; right &lt;(tmp_len))<br> {<br> if(tmp_allstr[left]==tmp_allstr[right])<br> {<br> i_arr[i]++;<br> }<br> else<br> {<br> break;<br> }<br> }<br> else<br> {<br> break;<br> }<br> }<br> }</p><p> int findI=0;<br> int findMaxLen=0;<br> for(int i=2;ifindMaxLen)<br> {<br> findMaxLen=i_arr[i];<br> findI=i;<br> }</p><p> }<br> int realSubLen=0;<br> if(findMaxLen&gt;0)<br> {<br> for(int i=findI-(findMaxLen)+1;i&lt;=findI+(findMaxLen)-1;i=i+2)<br> {<br> substr[realSubLen++]=tmp_allstr[i];<br> }<br> substr[realSubLen]='';<br> }</p><p> free (tmp_allstr);<br> tmp_allstr=NULL;<br> free (i_arr);//=(int *)malloc(sizeof(int)*(tmp_len));<br> i_arr=NULL;<br> return 1;<br> }</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_66063_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_66063_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX66063XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_66063_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_66063_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX66063XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_66063_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=66063#respond" onclick="return addComment.moveForm(&quot;comment-66063&quot;, &quot;66063&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-even depth-1" id="comment-66960"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/aef4fb0215aa823283069dea27053787" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">JS</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-66960"><span class="time-since">July 10, 2013</span></a></p></div><div class="comment-entry"><p>Won’t the preprocess() take quadratic time? substr() is linear is time.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_66960_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 0 down">+1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_66960_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX66960XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_66960_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_66960_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX66960XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_66960_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=66960#respond" onclick="return addComment.moveForm(&quot;comment-66960&quot;, &quot;66960&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-whynotlh even thread-odd thread-alt depth-1" id="comment-68388"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/whynotlh/" rel="nofollow"> <img src="./Manacher_Algorithm_files/7df434412ab6716ad4c6b254086b2f84" alt="Avatar Image" class="avatar user-17626-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/whynotlh/" rel="nofollow">Saber</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-68388"><span class="time-since">July 23, 2013</span></a></p></div><div class="comment-entry"><p>The algorithm you write is wrong. I believe it is because u type it faster than what u think:)<br> if P[ i' ] ≤ R – i,<br> then P[ i ] ← P[ i' ]<br> else P[ i ] ≥ P[ i' ]. (Which we have to expand past the right edge (R) to find P[ i ].</p><p>should be changed to:<br> if P[ i' ] &lt; R – i,<br> then P[ i ] ← P[ i' ]<br> else P[ i ] ≥ R – i. (Which we have to expand past the right edge (R) to find P[ i ].</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_68388_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 1 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_68388_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX68388XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_68388_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_68388_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX68388XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_68388_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=68388#respond" onclick="return addComment.moveForm(&quot;comment-68388&quot;, &quot;68388&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div><ul class="children"><li class="comment byuser comment-author-shuaiyangyang odd alt depth-2" id="comment-72097"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/shuaiyangyang/" rel="nofollow"> <img src="./Manacher_Algorithm_files/316791c593fb5c045405cc21cdec021f-bpthumb.jpg" alt="Avatar Image" class="avatar user-18588-avatar" width="25" height="25"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/shuaiyangyang/" rel="nofollow">shuaiyangyang</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-72097"><span class="time-since">August 20, 2013</span></a></p></div><div class="comment-entry"><p>if p[i] &gt; R -i then p[i] should equal to R-i.</p><p>only if p[i] = R-i then you have to expand</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_72097_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 1 down">-1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_72097_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX72097XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_72097_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_72097_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX72097XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_72097_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=72097#respond" onclick="return addComment.moveForm(&quot;comment-72097&quot;, &quot;72097&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ul></li><li class="comment byuser comment-author-shuaiyangyang even thread-even depth-1" id="comment-72095"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/shuaiyangyang/" rel="nofollow"> <img src="./Manacher_Algorithm_files/316791c593fb5c045405cc21cdec021f-bpthumb.jpg" alt="Avatar Image" class="avatar user-18588-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/shuaiyangyang/" rel="nofollow">shuaiyangyang</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-72095"><span class="time-since">August 20, 2013</span></a></p></div><div class="comment-entry"><p>Hey 1337, The relation should be:</p><p>if P[ i' ] &lt; R – i,</p><p>then P[ i ] ← P[ i' ]</p><p>else if P[ i ] = R – i. (Which we have to expand past the right edge (R) to find P[ i ].</p><p>else p[i] = R – i</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_72095_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 1 down">-1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_72095_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX72095XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_72095_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_72095_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX72095XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_72095_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=72095#respond" onclick="return addComment.moveForm(&quot;comment-72095&quot;, &quot;72095&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-fentoyal odd alt thread-odd thread-alt depth-1" id="comment-73246"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/fentoyal/" rel="nofollow"> <img src="./Manacher_Algorithm_files/27d7f612deb57e5d513abba8e994bae3" alt="Avatar Image" class="avatar user-21165-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/fentoyal/" rel="nofollow">Fentoyal</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-73246"><span class="time-since">September 1, 2013</span></a></p></div><div class="comment-entry"><p>This problem could be solved in O(n) time and O(1) space.<br> The test case attached here is what leetcode claims “wrong answer”, but I run it on my computer and it is exactly the same as the “expected answer”. I do not know why tho.<br> #include<br> #include<br> using namespace std;<br> class Solution {<br> int longestPalindromSubstrHelper(const string &amp; str, bool is_even, int &amp;cur_max_pivot, int &amp; cur_max_radius)<br> {<br> int cur_radius = 0, cur_pivot = 0;<br> for (size_t i = 0; i &lt; str.size(); ++i)<br> {</p><p> cur_radius = i – cur_pivot;<br> // cout&lt;&lt;cur_radius&lt;&lt;" "&lt;&lt;cur_pivot&lt;&lt;" "&lt;&lt;i&lt;= 0 &amp;&amp; str[cur_pivot - cur_radius + is_even] == str[i] &amp;&amp;cur_radius &gt;= cur_max_radius)<br> {<br> cur_max_radius =  cur_radius;<br> cur_max_pivot = cur_pivot;<br> }<br> while ((cur_pivot – cur_radius + is_even &lt; 0 ||str[cur_pivot - cur_radius +is_even] != str[i] ) &amp;&amp; cur_pivot &lt; i)<br> {<br> cur_pivot++;<br> cur_radius–;<br> //cout&lt;&lt;cur_radius&lt;&lt;" "&lt;&lt;cur_pivot&lt;&lt;" "&lt;&lt;i&lt;&lt;endl;<br> }<br> }<br> return 2 * cur_max_radius + !is_even;</p><p>}</p><p>public:<br> string longestPalindrome(string str) {<br> // Start typing your C/C++ solution below<br> // DO NOT write int main() function</p><p> int even_radius = 0, even_pivot = 0, odd_radius = 0, odd_pivot = 0;<br> int even_len = longestPalindromSubstrHelper(str, 1, even_pivot, even_radius );</p><p> int odd_len = longestPalindromSubstrHelper(str, 0, odd_pivot, odd_radius);<br> //cout&lt;&lt;even_len&lt;&lt;odd_len&lt;= odd_len)<br> {<br> return str.substr(even_pivot – even_radius + 1, 2 * even_radius);<br> }</p><p> return str.substr(odd_pivot – odd_radius, 2 * odd_radius+1);</p><p> }</p><p>};</p><p>int main()<br> {<br> Solution s;<br> //cout&lt;&lt;longestPalindromSubstrHelper("abababab",1)&lt;&lt;endl;<br> cout&lt;&lt;s.longestPalindrome("321012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210012321001232100123210123210012321001232100123210123")&lt;&lt;endl;<br> // cout&lt;&lt;longestPalindromSubstr("ababababa")&lt;&lt;endl;<br> }</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_73246_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 0 down">+1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_73246_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX73246XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_73246_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_73246_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX73246XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_73246_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=73246#respond" onclick="return addComment.moveForm(&quot;comment-73246&quot;, &quot;73246&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-79951"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/47e124cb7ff5675a464598ad929c1bbd" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">STANLEY</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-79951"><span class="time-since">October 28, 2013</span></a></p></div><div class="comment-entry"><p>if the string is atabcccbatabccccbata  the cause the longest p. string’s middle is ‘t’ in central. But as your algorithm, the when the i =t R is larger than i; so the t is gonna to equals to the t at the second place. is 3. how could this figure out?</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_79951_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_79951_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX79951XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_79951_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_79951_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX79951XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_79951_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=79951#respond" onclick="return addComment.moveForm(&quot;comment-79951&quot;, &quot;79951&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-stanley odd alt thread-odd thread-alt depth-1" id="comment-79954"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/stanley/" rel="nofollow"> <img src="./Manacher_Algorithm_files/47e124cb7ff5675a464598ad929c1bbd(1)" alt="Avatar Image" class="avatar user-26131-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/stanley/" rel="nofollow">stanley</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-79954"><span class="time-since">October 28, 2013</span></a></p></div><div class="comment-entry"><p>I’m not sure that cause you mean the R is the position which generated by the pivot’s left bound of previous D. And when you met i &lt; R it will equals to the min(), so If the string is atabcccbatabcccbata    the when D at the position of the second c, the R is gonna to be the a behind the second t. But so when the i turn to the t, t should equals to the min(), but t is the pivot of the longest substring, so how this work in the algorithm? I've got a little confuse.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_79954_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_79954_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX79954XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_79954_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_79954_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX79954XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_79954_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=79954#respond" onclick="return addComment.moveForm(&quot;comment-79954&quot;, &quot;79954&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-83732"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/4381a121cb4febdbcd19f98b1992d18b" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Atul Kumar</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-83732"><span class="time-since">November 15, 2013</span></a></p></div><div class="comment-entry"><p>Great !!!</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_83732_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_83732_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX83732XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_83732_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_83732_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX83732XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_83732_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=83732#respond" onclick="return addComment.moveForm(&quot;comment-83732&quot;, &quot;83732&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-88944"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/d485d3cf0a278a10e09f737e678146e0" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Mark</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-88944"><span class="time-since">November 30, 2013</span></a></p></div><div class="comment-entry"><p>A misleading post.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_88944_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 0 down">+1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_88944_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX88944XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_88944_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_88944_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX88944XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_88944_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=88944#respond" onclick="return addComment.moveForm(&quot;comment-88944&quot;, &quot;88944&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-121828"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/cfe902dff9ca43271c426dba2b012841" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Albert Chen</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-121828"><span class="time-since">February 2, 2014</span></a></p></div><div class="comment-entry"><p>Building suffix tree is O(n) and preprocessing a general tree for O(1) LCA queries is O(n).</p><p>We can build an extended suffix tree by inserting suffixes of reversed text into the same tree.</p><p>After these constructions, we enumerate the mid point in text (and we know the corresponding point in the reversed text). By looking at the LCA of the corresponding points in text and reversed text. We can decide in constant time that the longest palindrome from this mid point.</p><p>So we will be able to solve the problem in linear time (for odd length text.)</p><p>For more details, look into the book Algorithms on Strings, Trees and Sequences.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_121828_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_121828_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX121828XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_121828_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_121828_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX121828XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_121828_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=121828#respond" onclick="return addComment.moveForm(&quot;comment-121828&quot;, &quot;121828&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-122025"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/08eda2ce3c57e6009f025375fbe6e228" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Leet</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-122025"><span class="time-since">February 3, 2014</span></a></p></div><div class="comment-entry"><p></p><div id="crayon-53a668205b2a8" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 13px !important; line-height: 16px !important; height: auto;"><div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 16px !important; z-index: 0; opacity: 0; overflow: hidden;"> for (int i = 1; i &lt; t.length-1; i++) {

	           while (t[i + (1 + p[i])] == t[i - (1 + p[i])])
	                p[i]++;
	        }</textarea></div><div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><table class="crayon-table" style="margin-left: -28px;"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-num" data-line="crayon-53a668205b2a8-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205b2a8-2">2</div><div class="crayon-num" data-line="crayon-53a668205b2a8-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205b2a8-4">4</div><div class="crayon-num" data-line="crayon-53a668205b2a8-5">5</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-line" id="crayon-53a668205b2a8-1"><span class="h"> </span><span class="st">for</span><span class="h"> </span><span class="sy">(</span><span class="t">int</span><span class="h"> </span><span class="v">i</span><span class="h"> </span><span class="o">=</span><span class="h"> </span><span class="cn">1</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="h"> </span><span class="o">&lt;</span><span class="h"> </span><span class="v">t</span><span class="sy">.</span><span class="i">length</span><span class="o">-</span><span class="cn">1</span><span class="sy">;</span><span class="h"> </span><span class="i">i</span><span class="o">++</span><span class="sy">)</span><span class="h"> </span><span class="sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205b2a8-2">&nbsp;</div><div class="crayon-line" id="crayon-53a668205b2a8-3"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="st">while</span><span class="h"> </span><span class="sy">(</span><span class="v">t</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="sy">(</span><span class="cn">1</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">p</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">)</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="v">t</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="sy">(</span><span class="cn">1</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">p</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">)</span><span class="sy">]</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205b2a8-4"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">p</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">++</span><span class="sy">;</span></div><div class="crayon-line" id="crayon-53a668205b2a8-5"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="sy">}</span></div></div></td></tr></tbody></table></div></div><p></p><p>this itself wil give the solution..<br> Whats the need of center and right part.. plz expalin me</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_122025_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_122025_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX122025XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_122025_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_122025_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX122025XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_122025_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=122025#respond" onclick="return addComment.moveForm(&quot;comment-122025&quot;, &quot;122025&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-128103"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/153ffcdc0c1af218934115405798c3b2(1)" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">online chesstle</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-128103"><span class="time-since">February 15, 2014</span></a></p></div><div class="comment-entry"><p>s.substr((centerIndex – 1 – maxLen)/2, maxLen); is there a bug here as the rest of the code is treating P[i] as the length of the palindrome on either side of the center and not as the total length of the palindrome. maxlen is derived from P…</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_128103_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_128103_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX128103XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128103_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_128103_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX128103XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_128103_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=128103#respond" onclick="return addComment.moveForm(&quot;comment-128103&quot;, &quot;128103&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-149270"><div class="comment-avatar-box"><div class="avb"> <a href="http://www.acmerblog.com/" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/d80da29b562754f1f771ec897198e96e" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://www.acmerblog.com/" rel="nofollow">Acmerblog</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-149270"><span class="time-since">March 22, 2014</span></a></p></div><div class="comment-entry"><p>great job.I’m not sure that cause you mean the R is the position which generated by the pivot’s left bound of previous D. And when you met i &lt; R it will equals to the min(), so If the string is atabcccbatabcccbata the when D at the position of the second c, the R is gonna to be the a behind the second t. But so when the i turn to the t, t should equals to the min(), but t is the pivot of the longest substring, so how this work in the algorithm? I've got a little confuse.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_149270_c" class="gdt-size-20 gdthumbtext"> <strong title="1 up, 0 down">+1</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_149270_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX149270XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_149270_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_149270_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX149270XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_149270_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=149270#respond" onclick="return addComment.moveForm(&quot;comment-149270&quot;, &quot;149270&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-158219"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/62460d88d14eabbd0a86d0a2028abbc9" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Donne</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-158219"><span class="time-since">April 9, 2014</span></a></p></div><div class="comment-entry"><p>Why is the algoritmn O(n). The while loop where we attempt to expand the palindrome would need O(n) in worst case. eg. in case of b of the center. We are indirectly traversing all the nodes in that loop. So wont the order be O(n^2) ?</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_158219_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_158219_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX158219XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_158219_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_158219_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX158219XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_158219_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=158219#respond" onclick="return addComment.moveForm(&quot;comment-158219&quot;, &quot;158219&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-158882"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/762ba8f5955ed333352340bf791ecd70" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Alex</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-158882"><span class="time-since">April 11, 2014</span></a></p></div><div class="comment-entry"><p>Excellent post…. i don’t find any other posts which is as good and elaborate as this !! Good job.</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_158882_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_158882_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX158882XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_158882_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_158882_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX158882XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_158882_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=158882#respond" onclick="return addComment.moveForm(&quot;comment-158882&quot;, &quot;158882&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-minglotus even thread-even depth-1" id="comment-166993"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/minglotus/" rel="nofollow"> <img src="./Manacher_Algorithm_files/843788f593002b2c337b09e580bcedf8" alt="Avatar Image" class="avatar user-35818-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/minglotus/" rel="nofollow">programmingmonkey</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-166993"><span class="time-since">April 29, 2014</span></a></p></div><div class="comment-entry"><p></p><div id="crayon-53a668205ac9d" class="crayon-syntax crayon-theme-github crayon-font-consolas crayon-os-pc print-yes" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; float: none; clear: both; font-size: 13px !important; line-height: 16px !important; height: auto;"><div class="crayon-plain-wrap"><textarea wrap="off" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 16px !important; z-index: 0; opacity: 0; overflow: hidden;">  while (T[i + 1 + P[i]] == T[i - 1 - P[i]])
      P[i]++;</textarea></div><div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;"><table class="crayon-table" style="margin-left: -28px;"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-num" data-line="crayon-53a668205ac9d-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-53a668205ac9d-2">2</div></div></td><td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 16px !important;"><div class="crayon-line" id="crayon-53a668205ac9d-1"><span class="h">&nbsp;&nbsp;</span><span class="st">while</span><span class="h"> </span><span class="sy">(</span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">+</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="h"> </span><span class="o">==</span><span class="h"> </span><span class="v">T</span><span class="sy">[</span><span class="i">i</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="cn">1</span><span class="h"> </span><span class="o">-</span><span class="h"> </span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="sy">]</span><span class="sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-53a668205ac9d-2"><span class="h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="v">P</span><span class="sy">[</span><span class="i">i</span><span class="sy">]</span><span class="o">++</span><span class="sy">;</span></div></div></td></tr></tbody></table></div></div><p>perhaps this part needs a little more index checking to avoid segment fault?</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_166993_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_166993_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX166993XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_166993_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_166993_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX166993XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_166993_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=166993#respond" onclick="return addComment.moveForm(&quot;comment-166993&quot;, &quot;166993&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment byuser comment-author-daizanbeng odd alt thread-odd thread-alt depth-1" id="comment-181444"><div class="comment-avatar-box"><div class="avb"> <a href="http://leetcode.com/members/daizanbeng/" rel="nofollow"> <img src="./Manacher_Algorithm_files/0414f766d4ca25e7ac4134e23eb73bcd" alt="Avatar Image" class="avatar user-37801-avatar" width="50" height="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="http://leetcode.com/members/daizanbeng/" rel="nofollow">dqaxsefgt</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-181444"><span class="time-since">May 31, 2014</span></a></p></div><div class="comment-entry"><p>It`s a common sight to watch NBA players wearing Reebok brands during NBA games. Several young tennis stars also endorse for this brand of tennis shoes. Over the years Reebok has introduced many advanced technologies such as the DMX technology and Supportive CMEVA midsole to provide ultimate cushioning comfort to the players and enable easy movement in and around the court <a href="http://www.tnsugarafr.com/" rel="nofollow">Bottes Timberland</a> One popular brand of tennis shoes for women has also been designed by famous Hollywood actress Scarlett Johansson. Price wise, Reebok brand of tennis shoes are not too overtly costly unlike some other brands. Adidas:One of the earliest brands of tennis shoes.</p><div style="display: none">VN:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_181444_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_181444_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX181444XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_181444_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_181444_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX181444XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_181444_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=181444#respond" onclick="return addComment.moveForm(&quot;comment-181444&quot;, &quot;181444&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li><li class="comment even thread-even depth-1" id="comment-182563"><div class="comment-avatar-box"><div class="avb"> <a href="" rel="nofollow"> <img alt="" src="./Manacher_Algorithm_files/c0197b60c5a893daab0a9eb8db81d910" class="avatar avatar-50 photo" height="50" width="50"> </a></div></div><div class="comment-content"><div class="comment-meta"><p> <a href="" rel="nofollow">Bob</a> said on <a href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#comment-182563"><span class="time-since">June 3, 2014</span></a></p></div><div class="comment-entry"><p>Thank you for your clear explanation！！</p><div style="display: none">VA:F [1.9.22_1171]</div><div class="thumblock "><div class="ratingtext "><div id="gdsr_thumb_text_182563_c" class="gdt-size-20 gdthumbtext"> <strong title="0 up, 0 down">0</strong></div></div><span title="Vote Up (This comment is useful)"><div id="gdsr_thumb_182563_c_up" class="gdt-size-20 gdthumb gdup"><a id="gdsrX182563XupXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_182563_c_loader_up" style="display: none; width: 20px " class="ratingloader loadup"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><span title="Vote Down (This comment is not useful)"><div id="gdsr_thumb_182563_c_dw" class="gdt-size-20 gdthumb gddw"><a id="gdsrX182563XdwXcX46X20XY" class="gdt-starrating_gif" rel="nofollow"></a></div><div id="gdsr_thumb_182563_c_loader_dw" style="display: none; width: 20px " class="ratingloader loaddw"><div class="loader thumb radar" style="width: 20px; height: 20px;"></div></div></span><div class="raterclear"></div></div></div><div class="comment-options"> <a class="comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html?replytocom=182563#respond" onclick="return addComment.moveForm(&quot;comment-182563&quot;, &quot;182563&quot;, &quot;respond&quot;, &quot;993&quot;)">Reply</a></div></div></li></ol></div><div id="respond"><h3 id="reply-title">Leave a reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#respond" style="display:none;">Cancel reply</a></small></h3><form action="http://leetcode.com/wp-comments-post.php" method="post" id="commentform"><div class="comment-avatar-box"><div class="avb"> <img alt="" src="./Manacher_Algorithm_files/saved_resource" class="avatar avatar-50 photo avatar-default" height="50" width="50"></div></div><div class="comment-content standard-form"><p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p><p class="comment-form-author"><label for="author">Name<span class="required"> *</span></label> <input id="author" name="author" type="text" value="" size="30" aria-required="true"></p><p class="comment-form-email"><label for="email">Email<span class="required"> *</span></label> <input id="email" name="email" type="text" value="" size="30" aria-required="true"></p><p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30"></p><p class="form-textarea"><textarea name="comment" id="comment" cols="60" rows="10" aria-required="true" title="To embed your code, please use &lt;code&gt;your code here&lt;/code&gt;." class="defaultCommentText"></textarea></p><p class="form-allowed-tags">You may use the <code>&lt;code&gt;</code> tag to embed your code.</p><p class="form-submit"> <input name="submit" type="submit" id="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="993" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="58c2d5fb8b"></p></div></form></div><div id="trackbacks"><h3>15 trackbacks</h3><ul id="trackbacklist"><li><h5><a href="http://www.leetcode.com/2011/11/longest-palindromic-substring-part-i.html" rel="external nofollow" class="url">Longest Palindromic Substring Part I | LeetCode</a></h5> <em>on November 20, 2011</em></li><li><h5><a href="http://www.leetcode.com/2012/01/palindrome-number.html" rel="external nofollow" class="url">Palindrome Number | LeetCode</a></h5> <em>on January 4, 2012</em></li><li><h5><a href="http://interviewalgorithms.wordpress.com/2012/08/16/longest-palindromic-substring/" rel="external nofollow" class="url">Longest Palindromic Substring « Interview Algorithms</a></h5> <em>on August 16, 2012</em></li><li><h5><a href="http://www.sunkang.info/blog/2012/10/27/longest-palindromic-substring/" rel="external nofollow" class="url">Longest Palindromic Substring » KEVIN'S BLOG</a></h5> <em>on October 27, 2012</em></li><li><h5><a href="http://kevinyolo.com/tech/2013/02/26/longest-palindromic-substring/" rel="external nofollow" class="url">Longest Palindromic Substring » Kevin's Tech Blog</a></h5> <em>on February 25, 2013</em></li><li><h5><a href="http://tech-wonderland.net/blog/leetcode-longest-palindromic-substring.html" rel="external nofollow" class="url">leetcode: Longest Palindromic Substring solution | 烟客旅人 sigmainfy</a></h5> <em>on June 5, 2013</em></li><li><h5><a href="http://ziangwei.com/wordpress/?p=77" rel="external nofollow" class="url">[Leetcode]Longest Palindromic Substring | Wei's blog</a></h5> <em>on October 28, 2013</em></li><li><h5><a href="http://askprogramming.com/91909/manachers-algorithm-algorithm-to-find-longest-palindrome-substring-in-linear-time.html" rel="external nofollow" class="url">Manacher’s algorithm (algorithm to find longest palindrome substring in linear time) | Ask Programming &amp; Technology</a></h5> <em>on November 8, 2013</em></li><li><h5><a href="http://blog.mistysoul.net/archives/237" rel="external nofollow" class="url">[LeetCode]Longest Palindromic Substring | MistySoul</a></h5> <em>on November 9, 2013</em></li><li><h5><a href="http://jitingxu.wordpress.com/2014/01/12/longest-palindromic-substring/" rel="external nofollow" class="url">Longest Palindromic Substring | Jiting</a></h5> <em>on January 12, 2014</em></li><li><h5><a href="http://codesays.com/2014/solution-to-gamma2011-count-palindromic-slices-by-codility/" rel="external nofollow" class="url">Solution to gamma2011 (Count-Palindromic-Slices) by codility | Code Says</a></h5> <em>on February 5, 2014</em></li><li><h5><a href="http://www.elvisyu.com/longest-palindromic-substring/" rel="external nofollow" class="url">Longest Palindromic Substring | Elvis_Yu</a></h5> <em>on February 7, 2014</em></li><li><h5><a href="http://changhaz.wordpress.com/2014/04/21/leetcode-longest-palindromic-substring/" rel="external nofollow" class="url">(Leetcode) Longest Palindromic Substring | Changhaz's Codeplay</a></h5> <em>on April 21, 2014</em></li><li><h5><a href="http://smansoft.wordpress.com/2014/05/10/codenirvana-palidromic-number/" rel="external nofollow" class="url">CodeNirvana: Palidromic Number | {.SMan.Soft.}</a></h5> <em>on May 9, 2014</em></li><li><h5><a href="http://smansoft.wordpress.com/2014/05/10/codenirvana-palidromic-numbers/" rel="external nofollow" class="url">CodeNirvana: Palidromic Numbers | {.SMan.Soft.}</a></h5> <em>on May 9, 2014</em></li></ul></div></div></div></div><div id="post-dir-search" class="dir-search"><form role="search" method="get" id="searchform" action="http://leetcode.com/"> <input type="text" value="" name="s" id="s"> <input type="submit" id="searchsubmit" value="Search"></form></div><div id="sidebar"><div class="padder"></div></div></div><div id="push"></div></div><div id="footer"><div id="colophon"><div class="footer-widget"></div><div class="footer-widget"></div><div class="footer-widget"></div><div class="footer-widget last"></div><div class="clear"></div><div id="footer-links"><ul class="footer-menu"><li class="page_item page-item-2"><a href="http://leetcode.com/about">About</a></li><li class="page_item page-item-908"><a href="http://leetcode.com/activity">Activity</a></li><li class="page_item page-item-1466"><a href="http://leetcode.com/discuss">Discuss</a></li><li class="page_item page-item-1658"><a href="http://leetcode.com/donate">Donate</a></li><li class="page_item page-item-907"><a href="http://leetcode.com/members">Members</a></li><li class="page_item page-item-370"><a href="http://leetcode.com/onlinejudge">Online Judge</a></li></ul></div><div id="credits"><p>Copyright © 2014 LeetCode &nbsp;·&nbsp; <a href="http://leetcode.com/wp-login.php">Log in</a></p></div></div></div><div id="wpadminbar" class="" role="navigation"> <a class="screen-reader-shortcut" href="http://leetcode.com/2011/11/longest-palindromic-substring-part-ii.html#wp-toolbar" tabindex="1">Skip to toolbar</a><div class="quicklinks" id="wp-toolbar" role="navigation" aria-label="Top navigation toolbar." tabindex="0"><ul id="wp-admin-bar-root-default" class="ab-top-menu"><li id="wp-admin-bar-bp-login"><a class="ab-item" href="http://leetcode.com/wp-login.php">Log in</a></li><li id="wp-admin-bar-bp-register"><a class="ab-item" href="http://leetcode.com/register/">Register</a></li><li id="wp-admin-bar-my-account"><div class="ab-item ab-empty-item"></div></li></ul></div> <a class="screen-reader-shortcut" href="http://leetcode.com/wp-login.php?action=logout&_wpnonce=6417de4709">Log Out</a></div><div class="buddyboss_log"></div> <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6849839-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script><style type="text/css">
    .defaultCommentText { color: #a1a1a1; font-style: italic; }
  </style><script type="text/javascript">
    jQuery("textarea#comment, textarea#reply_text").focus(function(srcc) {
      if (jQuery(this).val() == jQuery(this)[0].title) {
        jQuery(this).val("");
        jQuery(this).removeClass("defaultCommentText");
      }
    });
    jQuery("textarea#comment, textarea#reply_text").blur(function() {
      if (jQuery(this).val() == "") {
        jQuery(this).val(jQuery(this)[0].title);
        jQuery(this).addClass("defaultCommentText");
      }
    });
    jQuery("textarea#comment, textarea#reply_text").attr('title', 'To embed your code, please use <code>your code here</code>.');
    jQuery("textarea#comment, textarea#reply_text").blur();
  </script>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Minified using disk: basic
Page Caching using disk: enhanced

 Served from: leetcode.com @ 2014-06-21 22:22:41 by W3 Total Cache --><div id="fancybox-tmp"></div><div id="fancybox-loading"><div></div></div><div id="fancybox-overlay"></div><div id="fancybox-wrap"><div id="fancybox-outer"><div id="fancybox-content"></div><a id="fancybox-close"></a><div id="fancybox-title"></div><a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a><a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a></div></div></body></html>